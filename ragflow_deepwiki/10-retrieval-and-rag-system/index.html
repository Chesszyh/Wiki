
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://wiki.neurosama.uk/ragflow_deepwiki/10-retrieval-and-rag-system/">
      
      
        <link rel="prev" href="10.4-response-generation-and-citations/">
      
      
        <link rel="next" href="../../redis_deepwiki/1-redis-overview/">
      
      
        
          <link rel="alternate" href="./" hreflang="en">
        
          <link rel="alternate" href="../../zh/ragflow_deepwiki/10-retrieval-and-rag-system/" hreflang="zh">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Retrieval and RAG System - DeepWiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#retrieval-and-rag-system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DeepWiki" class="md-header__button md-logo" aria-label="DeepWiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DeepWiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Retrieval and RAG System
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/ragflow_deepwiki/10-retrieval-and-rag-system/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Chesszyh/Wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Welcome to DeepWiki

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../celery_deepwiki/1-celery-overview/1.1-installation-and-setup/" class="md-tabs__link">
          
  
  
  Celery deepwiki

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../lc0_deepwiki/1-lc0-overview/" class="md-tabs__link">
          
  
  
  Lc0 deepwiki

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../linux_deepwiki/1-linux-kernel-overview/" class="md-tabs__link">
          
  
  
  Linux deepwiki

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../1-overview/" class="md-tabs__link">
          
  
  
  Ragflow deepwiki

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../redis_deepwiki/1-redis-overview/" class="md-tabs__link">
          
  
  
  Redis deepwiki

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../stockfish_deepwiki/2-core-data-structures-and-types/" class="md-tabs__link">
          
  
  
  Stockfish deepwiki

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DeepWiki" class="md-nav__button md-logo" aria-label="DeepWiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DeepWiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Chesszyh/Wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to DeepWiki
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Celery deepwiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Celery deepwiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    1 celery overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    1 celery overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/1-celery-overview/1.1-installation-and-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation and Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/1-celery-overview/1.2-core-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/1-celery-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Celery Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2 the celery application
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    2 the celery application
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/2-the-celery-application/2.1-application-initialization-and-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Application Initialization and Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/2-the-celery-application/2.2-task-registration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task Registration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/2-the-celery-application/2.3-message-brokers-and-routing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Message Brokers and Routing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/2-the-celery-application/2.4-amqp-layer-and-message-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AMQP Layer and Message Protocol
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/2-the-celery-application/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Celery Application
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3 tasks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    3 tasks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/3-tasks/3.1-task-definition-and-invocation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task Definition and Invocation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/3-tasks/3.2-task-lifecycle-and-states/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task Lifecycle and States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/3-tasks/3.3-error-handling-and-retry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling and Retry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/3-tasks/3.4-time-limits-and-rate-limits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time Limits and Rate Limits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/3-tasks/3.5-task-options-and-customization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task Options and Customization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/3-tasks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4 canvas workflows
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    4 canvas workflows
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/4-canvas-workflows/4.1-signatures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Signature and Composition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/4-canvas-workflows/4.2-workflow-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Primitives
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/4-canvas-workflows/4.3-advanced-canvas-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Canvas Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/4-canvas-workflows/4.4-chord-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chord Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/4-canvas-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Canvas Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5 workers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    5 workers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/5.1-worker-architecture-and-bootsteps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Worker Architecture and Bootsteps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/5.2-worker-lifecycle-and-shutdown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Worker Lifecycle and Shutdown
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/5.3-concurrency-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concurrency Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/5.4-worker-configuration-and-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Worker Configuration and Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/5.5-consumer-and-event-loops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Consumer and Event Loops
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/5.6-autoscaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autoscaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/5-workers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6 result backends
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    6 result backends
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/6-result-backends/6.1-backend-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backend Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/6-result-backends/6.2-backend-implementations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backend Implementations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/6-result-backends/6.3-result-storage-and-retrieval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Result Serialization and Retrieval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/6-result-backends/6.4-chord-coordination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chord Coordination
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/6-result-backends/6.5-backend-resilience/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling and Resilience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/6-result-backends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Result Backends
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_13" >
        
          
          <label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    7 periodic tasks (beat)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    7 periodic tasks (beat)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/7-periodic-tasks-%28beat%29/7.1-beat-scheduler-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Beat Scheduler Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/7-periodic-tasks-%28beat%29/7.2-schedule-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schedule Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/7-periodic-tasks-%28beat%29/7.3-time-and-timezone-handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time and Timezone Handling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/7-periodic-tasks-%28beat%29/7.4-persistent-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persistent Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/7-periodic-tasks-%28beat%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Periodic Tasks (Beat)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_15" >
        
          
          <label class="md-nav__link" for="__nav_2_15" id="__nav_2_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    8 monitoring and control
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    8 monitoring and control
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/8-monitoring-and-control/8.1-remote-control-commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Control Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/8-monitoring-and-control/8.2-worker-inspection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Worker Inspection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/8-monitoring-and-control/8.3-event-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/8-monitoring-and-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring and Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_17" >
        
          
          <label class="md-nav__link" for="__nav_2_17" id="__nav_2_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    9 command line interface
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    9 command line interface
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/9-command-line-interface/9.1-cli-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/9-command-line-interface/9.2-worker-and-beat-commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Worker and Beat Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/9-command-line-interface/9.3-management-commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Management Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/9-command-line-interface/9.4-multi-worker-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-worker Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/9-command-line-interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command Line Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_19" >
        
          
          <label class="md-nav__link" for="__nav_2_19" id="__nav_2_19_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    10 development and testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_19">
            <span class="md-nav__icon md-icon"></span>
            
  
    10 development and testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/10-development-and-testing/10.1-testing-infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/10-development-and-testing/10.2-test-matrix-and-environments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Matrix and Environments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/10-development-and-testing/10.3-integration-and-smoke-tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integration and Smoke Tests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/10-development-and-testing/10.4-code-quality-and-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Quality and Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/10-development-and-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development and Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_21" >
        
          
          <label class="md-nav__link" for="__nav_2_21" id="__nav_2_21_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    11 packaging and distribution
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_21">
            <span class="md-nav__icon md-icon"></span>
            
  
    11 packaging and distribution
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/11-packaging-and-distribution/11.1-package-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Package Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/11-packaging-and-distribution/11.2-dependencies-and-extras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dependencies and Extras
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/11-packaging-and-distribution/11.3-version-management-and-release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version Management and Release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../celery_deepwiki/11-packaging-and-distribution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Packaging and Distribution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Lc0 deepwiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Lc0 deepwiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/1-lc0-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lc0 Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2 building and installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    2 building and installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/2-building-and-installation/2.1-build-system-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build System Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/2-building-and-installation/2.2-linux-and-macos-build-process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux and macOS Build Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/2-building-and-installation/2.3-windows-build-process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows Build Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/2-building-and-installation/2.4-version-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Version Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/2-building-and-installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building and Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3 core engine architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3 core engine architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/3-core-engine-architecture/3.1-uci-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UCI Protocol Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/3-core-engine-architecture/3.2-configuration-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/3-core-engine-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Engine Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4 chess representation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    4 chess representation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/4-chess-representation/4.1-bitboards-and-move-generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bitboards
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/4-chess-representation/4.2-position-encoding-and-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Position Encoding and History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/4-chess-representation/4.3-syzygy-tablebase-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Syzygy Tablebase Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/4-chess-representation/4.4-pgn-and-game-import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PGN and Game Import
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/4-chess-representation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chess Representation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5 search algorithm
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    5 search algorithm
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/5-search-algorithm/5.1-mcts-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCTS Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/5-search-algorithm/5.2-search-parameters-and-stopping-conditions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Parameters and Stopping Conditions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/5-search-algorithm/5.3-search-tree-caching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Caching System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/5-search-algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Algorithm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6 neural network system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    6 neural network system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/6.1-network-interface-and-backend-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Interface and Backend Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/6.2-weights-loading-and-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weights Loading and Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/6.3-cuda-and-cudnn-backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CUDA and cuDNN Backend
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/6.4-onnx-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ONNX Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/6.5-xla-and-hlo-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    XLA and HLO Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/6.6-memory-caching-and-performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Caching and Performance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/6-neural-network-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neural Network System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_12" >
        
          
          <label class="md-nav__link" for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    7 self play system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    7 self play system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/7-self-play-system/7.1-tournament-organization-and-game-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tournament Organization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/7-self-play-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Play System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_14" >
        
          
          <label class="md-nav__link" for="__nav_3_14" id="__nav_3_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    8 utilities and infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    8 utilities and infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/8-utilities-and-infrastructure/8.1-fast-mathematical-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fast Mathematical Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/8-utilities-and-infrastructure/8.2-threading-and-synchronization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Threading and Synchronization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/8-utilities-and-infrastructure/8.3-benchmarking-and-performance-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarking and Performance Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/8-utilities-and-infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utilities and Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_16" >
        
          
          <label class="md-nav__link" for="__nav_3_16" id="__nav_3_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    9 continuous integration and deployment
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    9 continuous integration and deployment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/9-continuous-integration-and-deployment/9.1-circleci-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CircleCI Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/9-continuous-integration-and-deployment/9.2-windows-build-and-packaging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows Build and Packaging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lc0_deepwiki/9-continuous-integration-and-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Continuous Integration and Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Linux deepwiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux deepwiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/1-linux-kernel-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linux Kernel Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2 rust for linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    2 rust for linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/2-rust-for-linux/2.1-rust-kernel-apis-and-abstractions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust Kernel APIs and Abstractions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/2-rust-for-linux/2.2-nova-drm-graphics-driver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nova DRM Graphics Driver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/2-rust-for-linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust for Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3 virtualization (kvm)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3 virtualization (kvm)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/3-virtualization-%28kvm%29/3.1-kvm-x86-virtualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KVM x86 Virtualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/3-virtualization-%28kvm%29/3.2-kvm-arm64-virtualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KVM ARM64 Virtualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/3-virtualization-%28kvm%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Virtualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4 core kernel infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    4 core kernel infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/4-core-kernel-infrastructure/4.1-process-scheduling-and-sched_ext/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process Scheduling and sched_ext
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/4-core-kernel-infrastructure/4.2-tracing-and-observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tracing and Observability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/4-core-kernel-infrastructure/4.3-build-system-and-kbuild/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build System and Kbuild
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/4-core-kernel-infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Kernel Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5 storage and io
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    5 storage and io
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/5-storage-and-io/5.1-io_uring-asynchronous-io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    io_uring Asynchronous I/O
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/5-storage-and-io/5.2-btrfs-copy-on-write-filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Btrfs Copy-on-Write Filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/5-storage-and-io/5.3-ufs-storage-controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UFS Storage Controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/5-storage-and-io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage and I/O
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6 graphics and display
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    6 graphics and display
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/6-graphics-and-display/6.1-amdgpu-driver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AMDGPU Driver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux_deepwiki/6-graphics-and-display/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graphics and Display
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Ragflow deepwiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ragflow deepwiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    2 getting started and deployment
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    2 getting started and deployment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-getting-started-and-deployment/2.1-docker-compose-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Compose Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-getting-started-and-deployment/2.4-build-system-and-cicd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build System and CI/CD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-getting-started-and-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started and Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    3 system architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3 system architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-system-architecture/3.1-core-application-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Application Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-system-architecture/3.2-data-storage-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Storage Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-system-architecture/3.3-task-execution-and-queue-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Task Execution and Queue System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-system-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    4 frontend application
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    4 frontend application
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-frontend-application/4.1-internationalization-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Internationalization System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-frontend-application/4.2-application-structure-and-ui-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Application Structure and Routing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-frontend-application/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Frontend Application
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    5 llm integration system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    5 llm integration system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-llm-integration-system/5.1-model-factory-pattern-and-registration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Factory Pattern and Registration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-llm-integration-system/5.2-provider-implementations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Provider Implementations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-llm-integration-system/5.3-error-handling-and-retry-logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling and Retry Logic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-llm-integration-system/5.4-tenant-configuration-and-usage-tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tenant Configuration and Usage Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-llm-integration-system/5.5-tool-calling-and-function-use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool Calling and Function Use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5-llm-integration-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Integration System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    6 document processing pipeline
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    6 document processing pipeline
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/6.1-document-parsing-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Document Parsing Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/6.2-chunking-methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chunking Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/6.3-content-enhancement-and-embedding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content Enhancement and Embedding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/6.4-layout-recognition-and-ocr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Layout Recognition and OCR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/6.5-knowledge-graph-construction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Knowledge Graph Construction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/6.6-raptor-hierarchical-summarization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RAPTOR Hierarchical Summarization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-document-processing-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Document Processing Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_12" >
        
          
          <label class="md-nav__link" for="__nav_5_12" id="__nav_5_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    7 data source integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    7 data source integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-data-source-integration/7.1-connector-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connector Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-data-source-integration/7.2-synchronization-and-scheduling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Synchronization and Scheduling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-data-source-integration/7.3-supported-data-sources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Supported Data Sources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-data-source-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Source Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_14" >
        
          
          <label class="md-nav__link" for="__nav_5_14" id="__nav_5_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    8 backend api system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    8 backend api system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-backend-api-system/8.1-api-architecture-and-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Architecture and SDK
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-backend-api-system/8.2-authentication-and-authorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication and Multi-tenancy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-backend-api-system/8.3-dataset-and-knowledge-base-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dataset and Knowledge Base APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-backend-api-system/8.4-document-and-file-management-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Document and File Management APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-backend-api-system/8.5-chat-and-conversation-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chat and Conversation APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-backend-api-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backend API System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_16" >
        
          
          <label class="md-nav__link" for="__nav_5_16" id="__nav_5_16_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    9 agent and workflow system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    9 agent and workflow system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.1-canvas-engine-and-dsl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Canvas Engine and DSL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.2-component-system-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Component System Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.3-built-in-components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Built-in Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.4-workflow-execution-and-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Execution and Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.5-state-and-variable-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State and Variable Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.6-agent-tools-and-react-loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Tools and ReAct Loop
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/9.7-canvas-api-and-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Canvas API and Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-agent-and-workflow-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent and Workflow System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_18" >
        
          
          <label class="md-nav__link" for="__nav_5_18" id="__nav_5_18_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    10 retrieval and rag system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_18">
            <span class="md-nav__icon md-icon"></span>
            
  
    10 retrieval and rag system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="10.1-query-processing-and-refinement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Processing and Refinement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="10.2-hybrid-search-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hybrid Search Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="10.3-reranking-and-metadata-filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reranking and Metadata Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="10.4-response-generation-and-citations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Response Generation and Citations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Retrieval and RAG System
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Retrieval and RAG System
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#purpose-and-scope" class="md-nav__link">
    <span class="md-ellipsis">
      
        Purpose and Scope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Architecture Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entry-points-and-api-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entry Points and API Flow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-processing-and-refinement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Query Processing and Refinement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Query Processing and Refinement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multi-turn-question-refinement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Turn Question Refinement
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-search-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Search Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hybrid Search Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keyword-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keyword Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fusion Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fallback-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fallback Strategy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieval-method-invocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Retrieval Method Invocation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reranking-and-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reranking and Scoring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reranking and Scoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-based-reranking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model-Based Reranking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-similarity-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Similarity Scoring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-generation-with-context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response Generation with Context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Response Generation with Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Formatting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-fitting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Message Fitting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-prompt-construction" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Prompt Construction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Streaming Response
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citation-insertion-mechanism" class="md-nav__link">
    <span class="md-ellipsis">
      
        Citation Insertion Mechanism
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Citation Insertion Mechanism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-citation-insertion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Citation Insertion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-citation-parsing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manual Citation Parsing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bad-format-repair" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bad Format Repair
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference Filtering
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citation-prompt-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Citation Prompt Injection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toc-enhancement-for-long-documents" class="md-nav__link">
    <span class="md-ellipsis">
      
        TOC Enhancement for Long Documents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parent-child-chunk-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parent-Child Chunk Retrieval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knowledge-graph-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Knowledge Graph Integration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tavily-web-search-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tavily Web Search Integration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-reasoning-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deep Reasoning Mode
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-based-retrieval-for-structured-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL-Based Retrieval for Structured Data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-decoration-and-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response Decoration and Metadata
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-based-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metadata-Based Filtering
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-generation-during-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Embedding Generation During Retrieval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#empty-response-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Empty Response Handling
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openai-compatible-api-response-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenAI-Compatible API Response Format
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chunk-data-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chunk Data Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document-aggregation-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Document Aggregation Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-with-agent-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration with Agent System
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Redis deepwiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Redis deepwiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/1-redis-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2 redis core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    2 redis core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/2-redis-core/2.1-server-architecture-and-lifecycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Server Architecture and Lifecycle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/2-redis-core/2.2-client-connection-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client Connection Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/2-redis-core/2.3-command-processing-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command Processing Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/2-redis-core/2.4-configuration-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/2-redis-core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis Core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3 data storage and management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3 data storage and management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/3.1-core-data-types-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Data Types Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/3.2-streams-and-blocking-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streams and Blocking Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/3.3-hyperloglog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HyperLogLog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/3.4-memory-efficient-data-structures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory-Efficient Data Structures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/3.5-dictionary-and-key-value-store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dictionary and Key-Value Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/3.6-dynamic-string-library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dynamic String Library
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/3-data-storage-and-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Storage and Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4 memory management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    4 memory management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/4-memory-management/4.1-eviction-and-expiration-policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Eviction and Expiration Policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/4-memory-management/4.2-memory-allocators-and-build-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Allocators and Build System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/4-memory-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_8" >
        
          
          <label class="md-nav__link" for="__nav_6_8" id="__nav_6_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5 scripting and extensions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    5 scripting and extensions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/5-scripting-and-extensions/5.1-lua-scripting-and-redis-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lua Scripting and Redis Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/5-scripting-and-extensions/5.2-redis-module-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis Module API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/5-scripting-and-extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scripting and Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_10" >
        
          
          <label class="md-nav__link" for="__nav_6_10" id="__nav_6_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6 high availability and distribution
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    6 high availability and distribution
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/6-high-availability-and-distribution/6.1-redis-cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis Cluster
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/6-high-availability-and-distribution/6.2-redis-sentinel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis Sentinel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/6-high-availability-and-distribution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    High Availability and Scaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/7-persistence-and-replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persistence and Replication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_13" >
        
          
          <label class="md-nav__link" for="__nav_6_13" id="__nav_6_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    8 security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    8 security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/8-security/8.1-access-control-lists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Access Control Lists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/8-security/8.2-network-security-and-tls/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Security and TLS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/8-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_15" >
        
          
          <label class="md-nav__link" for="__nav_6_15" id="__nav_6_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    9 client tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    9 client tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/9-client-tools/9.1-redis-cli-and-benchmark-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis CLI and Benchmark Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/9-client-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_17" >
        
          
          <label class="md-nav__link" for="__nav_6_17" id="__nav_6_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    10 development and testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    10 development and testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/10-development-and-testing/10.1-build-system-and-dependencies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build System and Dependencies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/10-development-and-testing/10.2-testing-framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/10-development-and-testing/10.3-continuous-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Continuous Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../redis_deepwiki/10-development-and-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development and Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stockfish deepwiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stockfish deepwiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/2-core-data-structures-and-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Data Structures and Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3 board representation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    3 board representation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/3-board-representation/3.1-position-and-state-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Position and State Management
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/3-board-representation/3.2-bitboards-and-low-level-operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bitboards and Low-level Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/3-board-representation/3.3-move-generation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Move Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/3-board-representation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Board Representation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4 search system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    4 search system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/4-search-system/4.1-search-algorithm-and-iterative-deepening/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Algorithm and Iterative Deepening
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/4-search-system/4.2-thread-management-and-parallel-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thread Management and Parallel Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/4-search-system/4.3-move-ordering-and-move-picker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Move Ordering and Move Picker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/4-search-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5 evaluation system
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    5 evaluation system
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/5-evaluation-system/5.1-nnue-neural-network-evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NNUE Neural Network Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/5-evaluation-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6 external interface
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    6 external interface
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/6-external-interface/6.1-uci-protocol-handler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UCI Protocol Handler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/6-external-interface/6.2-uci-options-and-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UCI Options and Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/6-external-interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    External Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_10" >
        
          
          <label class="md-nav__link" for="__nav_7_10" id="__nav_7_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    7 infrastructure and support
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    7 infrastructure and support
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/7-infrastructure-and-support/7.1-build-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/7-infrastructure-and-support/7.2-utilities-and-support-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utilities and Support Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/7-infrastructure-and-support/7.3-testing-and-benchmarking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing and Benchmarking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stockfish_deepwiki/7-infrastructure-and-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure and Support
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#purpose-and-scope" class="md-nav__link">
    <span class="md-ellipsis">
      
        Purpose and Scope
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Architecture Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entry-points-and-api-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entry Points and API Flow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-processing-and-refinement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Query Processing and Refinement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Query Processing and Refinement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#multi-turn-question-refinement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-Turn Question Refinement
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-search-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Search Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hybrid Search Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keyword-search" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keyword Search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fusion-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fusion Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fallback-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fallback Strategy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#retrieval-method-invocation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Retrieval Method Invocation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reranking-and-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reranking and Scoring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reranking and Scoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model-based-reranking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model-Based Reranking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-similarity-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hybrid Similarity Scoring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-generation-with-context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response Generation with Context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Response Generation with Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Formatting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-fitting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Message Fitting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-prompt-construction" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Prompt Construction
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#streaming-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Streaming Response
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citation-insertion-mechanism" class="md-nav__link">
    <span class="md-ellipsis">
      
        Citation Insertion Mechanism
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Citation Insertion Mechanism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-citation-insertion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automatic Citation Insertion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-citation-parsing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manual Citation Parsing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bad-format-repair" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bad Format Repair
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference Filtering
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#citation-prompt-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Citation Prompt Injection
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toc-enhancement-for-long-documents" class="md-nav__link">
    <span class="md-ellipsis">
      
        TOC Enhancement for Long Documents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parent-child-chunk-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parent-Child Chunk Retrieval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knowledge-graph-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Knowledge Graph Integration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tavily-web-search-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tavily Web Search Integration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-reasoning-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deep Reasoning Mode
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-based-retrieval-for-structured-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL-Based Retrieval for Structured Data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-decoration-and-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      
        Response Decoration and Metadata
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-based-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metadata-Based Filtering
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embedding-generation-during-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Embedding Generation During Retrieval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#empty-response-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Empty Response Handling
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openai-compatible-api-response-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        OpenAI-Compatible API Response Format
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chunk-data-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chunk Data Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document-aggregation-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Document Aggregation Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-with-agent-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration with Agent System
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="retrieval-and-rag-system">Retrieval and RAG System<a class="headerlink" href="#retrieval-and-rag-system" title="Permanent link">&para;</a></h1>
<p>Relevant source files</p>
<ul>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/agent/tools/retrieval.py">agent/tools/retrieval.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/chunk_app.py">api/apps/chunk_app.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/conversation_app.py">api/apps/conversation_app.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/document_app.py">api/apps/document_app.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/file2document_app.py">api/apps/file2document_app.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/file_app.py">api/apps/file_app.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/kb_app.py">api/apps/kb_app.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/chat.py">api/apps/sdk/chat.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/dataset.py">api/apps/sdk/dataset.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/dify_retrieval.py">api/apps/sdk/dify_retrieval.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/doc.py">api/apps/sdk/doc.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/session.py">api/apps/sdk/session.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/db_models.py">api/db/db_models.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/canvas_service.py">api/db/services/canvas_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/conversation_service.py">api/db/services/conversation_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py">api/db/services/dialog_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/document_service.py">api/db/services/document_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/file_service.py">api/db/services/file_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/knowledgebase_service.py">api/db/services/knowledgebase_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/task_service.py">api/db/services/task_service.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/utils/api_utils.py">api/utils/api_utils.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/docs/references/http_api_reference.md">docs/references/http_api_reference.md</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/docs/references/python_api_reference.md">docs/references/python_api_reference.md</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/docs/release_notes.md">docs/release_notes.md</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/advanced_rag/__init__.py">rag/advanced_rag/__init__.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/benchmark.py">rag/benchmark.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py">rag/nlp/search.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/task_executor.py">rag/svr/task_executor.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/sdk/python/ragflow_sdk/modules/chat.py">sdk/python/ragflow_sdk/modules/chat.py</a></li>
<li><a href="https://github.com/infiniflow/ragflow/blob/80a16e71/sdk/python/ragflow_sdk/ragflow.py">sdk/python/ragflow_sdk/ragflow.py</a></li>
</ul>
<h2 id="purpose-and-scope">Purpose and Scope<a class="headerlink" href="#purpose-and-scope" title="Permanent link">&para;</a></h2>
<p>This document describes RAGFlow's Retrieval-Augmented Generation (RAG) system, which processes user queries, retrieves relevant knowledge chunks from indexed documents, reranks results, and generates grounded responses with citations. The system implements hybrid search combining vector similarity and BM25 keyword matching, sophisticated reranking strategies, and automatic citation insertion.</p>
<p>For information about document processing and indexing that precedes retrieval, see <a href="/infiniflow/ragflow/6-document-processing-pipeline">Document Processing Pipeline</a>. For agent-based retrieval workflows, see <a href="/infiniflow/ragflow/9-agent-and-workflow-system">Agent and Workflow System</a>. For the HTTP and SDK interfaces to the RAG system, see <a href="/infiniflow/ragflow/8-backend-api-system">Backend API System</a>.</p>
<h2 id="system-architecture-overview">System Architecture Overview<a class="headerlink" href="#system-architecture-overview" title="Permanent link">&para;</a></h2>
<p>The RAG pipeline executes the following stages:</p>
<p><pre class="mermaid"><code>flowchart TD
    UserQuery["User Query"]
    QueryProc["Query Processing"]
    Search["Hybrid Search"]
    Rerank["Reranking"]
    GenResp["Response Generation"]
    Citations["Citation Insertion"]
    FinalAnswer["Final Answer"]

    UserQuery --&gt; QueryProc
    QueryProc --&gt; Search
    Search --&gt; Rerank
    Rerank --&gt; GenResp
    GenResp --&gt; Citations
    Citations --&gt; FinalAnswer
    QueryProc --&gt; Search
    Search --&gt; Rerank
    Rerank --&gt; GenResp
    GenResp --&gt; Citations
    Citations --&gt; FinalAnswer</code></pre>
<strong>Retrieval-Augmented Generation Pipeline</strong></p>
<p>The system coordinates multiple subsystems:</p>
<ul>
<li><strong>Query Processing</strong>: Translates queries, refines multi-turn context, extracts keywords</li>
<li><strong>Hybrid Search</strong>: Combines vector embeddings and BM25 text matching via weighted fusion</li>
<li><strong>Reranking</strong>: Uses rerank models or hybrid similarity scoring to prioritize chunks</li>
<li><strong>Response Generation</strong>: Formats context, calls LLM with system prompts</li>
<li><strong>Citation Insertion</strong>: Embeds references into the generated answer</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L275-L583">api/db/services/dialog_service.py275-583</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L37-L172">rag/nlp/search.py37-172</a></p>
<h2 id="entry-points-and-api-flow">Entry Points and API Flow<a class="headerlink" href="#entry-points-and-api-flow" title="Permanent link">&para;</a></h2>
<p>The RAG system is invoked through multiple interfaces:</p>
<p><pre class="mermaid"><code>flowchart TD
    ChatOpenAI["/v1/chats_openai/{chat_id}/chat/completions"]
    ChatSDK["/api/v1/chats/{chat_id}/completions"]
    SessionSDK["/api/v1/chats/{chat_id}/sessions/{session_id}"]
    AsyncChat["async_chat()"]
    GetModels["get_models()"]
    Retrieval["retriever.retrieval()"]
    DialogServicePy["api/db/services/dialog_service.py"]

    ChatOpenAI --&gt; AsyncChat
    ChatSDK --&gt; AsyncChat
    SessionSDK --&gt; AsyncChat
    AsyncChat --&gt; GetModels
    AsyncChat --&gt; Retrieval
    GetModels --&gt; DialogServicePy
    Retrieval --&gt; DialogServicePy</code></pre>
<strong>RAG System Entry Points</strong></p>
<p>The primary entry point is <code>async_chat()</code> in <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L275-L275">api/db/services/dialog_service.py275</a> which orchestrates the entire pipeline. It is called from:</p>
<ul>
<li>OpenAI-compatible endpoint: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/session.py#L180-L436">api/apps/sdk/session.py180-436</a></li>
<li>Native SDK endpoint: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/session.py#L129-L177">api/apps/sdk/session.py129-177</a></li>
<li>Web UI endpoint: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/conversation_app.py#L137-L194">api/apps/conversation_app.py137-194</a></li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L275-L583">api/db/services/dialog_service.py275-583</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/session.py#L180-L436">api/apps/sdk/session.py180-436</a></p>
<h2 id="query-processing-and-refinement">Query Processing and Refinement<a class="headerlink" href="#query-processing-and-refinement" title="Permanent link">&para;</a></h2>
<p>Before retrieval, the system refines user queries through multiple transformations:</p>
<h3 id="multi-turn-question-refinement">Multi-Turn Question Refinement<a class="headerlink" href="#multi-turn-question-refinement" title="Permanent link">&para;</a></h3>
<p><pre class="mermaid"><code>flowchart TD
    Messages["messages[-3:]"]
    CheckMultiturn["refine_multiturn?"]
    FullQuestion["full_question()"]
    LastQuestion["questions[-1]"]
    CrossLang["cross_languages()"]
    KeywordExt["keyword_extraction()"]
    FinalQuery["Final Query"]

    Messages --&gt; CheckMultiturn
    CheckMultiturn --&gt; FullQuestion
    CheckMultiturn --&gt; LastQuestion
    FullQuestion --&gt; CrossLang
    LastQuestion --&gt; CrossLang
    CrossLang --&gt; KeywordExt
    KeywordExt --&gt; FinalQuery</code></pre>
<strong>Query Refinement Pipeline</strong></p>
<p>The refinement process:</p>
<ol>
<li>
<p><strong>Multi-Turn Context</strong> (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L349-L352">api/db/services/dialog_service.py349-352</a>):</p>
<ul>
<li>Extracts last 3 user messages from conversation history</li>
<li>If <code>prompt_config.get("refine_multiturn")</code> is enabled, calls <code>full_question()</code> to condense context</li>
<li>Otherwise uses only the last question</li>
<li>
<p><strong>Cross-Language Translation</strong> (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L354-L355">api/db/services/dialog_service.py354-355</a>):</p>
</li>
<li>
<p>If <code>prompt_config.get("cross_languages")</code> is set, translates query to target languages</p>
</li>
<li>Implementation in <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a> using <code>cross_languages()</code> function</li>
<li>
<p><strong>Keyword Extraction</strong> (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L367-L368">api/db/services/dialog_service.py367-368</a>):</p>
</li>
<li>
<p>If <code>prompt_config.get("keyword")</code> is true, appends extracted keywords to query</p>
</li>
<li>Uses LLM-based keyword extraction via <code>keyword_extraction(chat_mdl, questions[-1])</code></li>
<li>
<p><strong>Metadata Filtering</strong> (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L357-L365">api/db/services/dialog_service.py357-365</a>):</p>
</li>
<li>
<p>Applies <code>dialog.meta_data_filter</code> to pre-filter documents</p>
</li>
<li>Calls <code>apply_meta_data_filter()</code> to convert filter expressions to document IDs</li>
<li>Restricts retrieval to matching <code>attachments</code> list</li>
</ul>
</li>
</ol>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L349-L368">api/db/services/dialog_service.py349-368</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a></p>
<h2 id="hybrid-search-architecture">Hybrid Search Architecture<a class="headerlink" href="#hybrid-search-architecture" title="Permanent link">&para;</a></h2>
<p>The <code>Dealer</code> class in <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L37-L37">rag/nlp/search.py37</a> implements hybrid search combining vector and keyword retrieval:</p>
<p><pre class="mermaid"><code>flowchart TD
    GetVector["get_vector()Encode query"]
    GetFilters["get_filters()doc_ids, kb_ids"]
    Search["search()Main entry"]
    MatchText["MatchTextExprBM25 keyword"]
    MatchDense["MatchDenseExprVector similarity"]
    FusionExpr["FusionExprweighted_sum"]
    DocStoreSearch["docStoreConn.search()"]
    ElasticsearchES["Elasticsearch"]
    InfinityInf["Infinity"]

    Search --&gt; GetVector
    Search --&gt; GetFilters
    Search --&gt; MatchText
    Search --&gt; MatchDense
    GetVector --&gt; MatchDense
    MatchText --&gt; FusionExpr
    MatchDense --&gt; FusionExpr
    FusionExpr --&gt; DocStoreSearch
    DocStoreSearch --&gt; ElasticsearchES
    DocStoreSearch --&gt; InfinityInf</code></pre>
<strong>Dealer Hybrid Search Architecture</strong></p>
<h3 id="vector-search">Vector Search<a class="headerlink" href="#vector-search" title="Permanent link">&para;</a></h3>
<p>The <code>get_vector()</code> method (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L53-L61">rag/nlp/search.py53-61</a>):</p>
<ul>
<li>Encodes query text using <code>emb_mdl.encode_queries(txt)</code></li>
<li>Creates <code>MatchDenseExpr</code> with vector column name <code>q_{len}_vec</code></li>
<li>Parameters: <code>topk</code>, similarity threshold (default 0.1)</li>
<li>Returns embedding data as float array</li>
</ul>
<h3 id="keyword-search">Keyword Search<a class="headerlink" href="#keyword-search" title="Permanent link">&para;</a></h3>
<p>The <code>search()</code> method constructs <code>MatchTextExpr</code> (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L115-L115">rag/nlp/search.py115</a>):</p>
<ul>
<li>Uses <code>self.qryr.question(qst, min_match=0.3)</code> to tokenize query</li>
<li>Generates BM25-based keyword matching expression</li>
<li>Highlights fields: <code>content_ltks</code>, <code>title_tks</code></li>
</ul>
<h3 id="fusion-strategy">Fusion Strategy<a class="headerlink" href="#fusion-strategy" title="Permanent link">&para;</a></h3>
<p>The <code>FusionExpr</code> combines both modalities (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L128-L129">rag/nlp/search.py128-129</a>):</p>
<ul>
<li>Formula: <code>weighted_sum</code> with weights <code>"0.05,0.95"</code> (5% keyword, 95% vector)</li>
<li>Configured via <code>FusionExpr("weighted_sum", topk, {"weights": "0.05,0.95"})</code></li>
<li>Adjustable through dialog settings: <code>vector_similarity_weight</code>, <code>similarity_threshold</code></li>
</ul>
<h3 id="fallback-strategy">Fallback Strategy<a class="headerlink" href="#fallback-strategy" title="Permanent link">&para;</a></h3>
<p>If no results found, the system retries with relaxed parameters (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L136-L148">rag/nlp/search.py136-148</a>):</p>
<ul>
<li>Reduces <code>min_match</code> from 0.3 to 0.1</li>
<li>Lowers similarity threshold from 0.1 to 0.17</li>
<li>If <code>doc_id</code> filter present, searches without text/vector matching</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L37-L172">rag/nlp/search.py37-172</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L417-L430">api/db/services/dialog_service.py417-430</a></p>
<h2 id="retrieval-method-invocation">Retrieval Method Invocation<a class="headerlink" href="#retrieval-method-invocation" title="Permanent link">&para;</a></h2>
<p>The retrieval call from <code>async_chat()</code>:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a># From api/db/services/dialog_service.py:417-430
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>kbinfos = await retriever.retrieval(
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    &quot; &quot;.join(questions),
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    embd_mdl,
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    tenant_ids,
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    dialog.kb_ids,
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    1,                              # page
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    dialog.top_n,                   # page_size
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    dialog.similarity_threshold,
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    dialog.vector_similarity_weight,
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    doc_ids=attachments,
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    top=dialog.top_k,
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    aggs=True,
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    rerank_mdl=rerank_mdl,
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    rank_feature=label_question(&quot; &quot;.join(questions), kbs),
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>)
</code></pre></div>
Parameters:</p>
<ul>
<li><code>top_n</code>: Number of chunks to retrieve (default: from dialog settings)</li>
<li><code>top_k</code>: Final number after reranking</li>
<li><code>similarity_threshold</code>: Minimum vector similarity (0.0-1.0)</li>
<li><code>vector_similarity_weight</code>: Balance between vector/keyword (0.0-1.0)</li>
<li><code>rank_feature</code>: Tag-based ranking scores from <code>label_question()</code></li>
</ul>
<p>The retrieval returns <code>kbinfos</code> dict containing:</p>
<ul>
<li><code>chunks</code>: List of retrieved chunk dictionaries</li>
<li><code>doc_aggs</code>: Document-level aggregations with counts</li>
<li><code>total</code>: Total matching chunks</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L417-L430">api/db/services/dialog_service.py417-430</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/app/tag.py">rag/app/tag.py</a></p>
<h2 id="reranking-and-scoring">Reranking and Scoring<a class="headerlink" href="#reranking-and-scoring" title="Permanent link">&para;</a></h2>
<p>The reranking phase prioritizes the most relevant chunks:</p>
<p><pre class="mermaid"><code>flowchart TD
    SearchResults["Search Results"]
    CheckRerank["rerank_mdl?"]
    RerankModel["rerank_by_model()"]
    HybridSim["Hybrid Similarity"]
    FinalRank["Final Ranking"]
    RankFeature["_rank_feature_scores()"]
    TopK["Select top_k"]

    SearchResults --&gt; CheckRerank
    CheckRerank --&gt; RerankModel
    CheckRerank --&gt; HybridSim
    RerankModel --&gt; FinalRank
    HybridSim --&gt; RankFeature
    RankFeature --&gt; FinalRank
    FinalRank --&gt; TopK</code></pre>
<strong>Reranking Strategy Selection</strong></p>
<h3 id="model-based-reranking">Model-Based Reranking<a class="headerlink" href="#model-based-reranking" title="Permanent link">&para;</a></h3>
<p>When a rerank model is configured (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L296-L313">rag/nlp/search.py296-313</a>):</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>def rerank(self, sres, query, tkweight=0.3, vtweight=0.7,
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>           rerank_mdl=None, rank_feature=None):
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    if rerank_mdl:
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>        return self.rerank_by_model(sres, query, rerank_mdl)
</code></pre></div>
The <code>rerank_by_model()</code> method:</p>
<ul>
<li>Sends query + chunk pairs to rerank model</li>
<li>Model returns relevance scores (0.0-1.0)</li>
<li>Sorts chunks by score descending</li>
<li>Configured models: Jina reranker, Cohere rerank, BGE-reranker</li>
</ul>
<h3 id="hybrid-similarity-scoring">Hybrid Similarity Scoring<a class="headerlink" href="#hybrid-similarity-scoring" title="Permanent link">&para;</a></h3>
<p>Without a rerank model, uses hybrid scoring (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L332-L350">rag/nlp/search.py332-350</a>):</p>
<ol>
<li><strong>Token Similarity</strong>: BM25 score between query and chunk tokens</li>
<li><strong>Vector Similarity</strong>: Cosine similarity between embeddings</li>
<li><strong>Rank Feature Score</strong>: Tag-based relevance from <code>_rank_feature_scores()</code></li>
<li><strong>Page Rank</strong>: Document-level importance score from <code>PAGERANK_FLD</code></li>
</ol>
<p>Combined formula:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sim = tkweight * tksim + vtweight * vtsim + rank_feature_scores
</code></pre></div>
The <code>_rank_feature_scores()</code> method (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L268-L293">rag/nlp/search.py268-293</a>):</p>
<ul>
<li>Compares query tags with chunk tags from <code>TAG_FLD</code></li>
<li>Computes cosine similarity between tag vectors</li>
<li>Adds static <code>PAGERANK_FLD</code> values (0-100)</li>
<li>Formula: <code>tag_similarity * 10.0 + pagerank</code></li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L268-L350">rag/nlp/search.py268-350</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L417-L430">api/db/services/dialog_service.py417-430</a></p>
<h2 id="response-generation-with-context">Response Generation with Context<a class="headerlink" href="#response-generation-with-context" title="Permanent link">&para;</a></h2>
<p>After retrieval and reranking, the system generates responses:</p>
<p><pre class="mermaid"><code>flowchart TD
    Chunks["Retrieved Chunks"]
    KbPrompt["kb_prompt()"]
    FormatContext["Format Context"]
    SystemPrompt["System Prompt"]
    Messages["Conversation History"]
    MsgFitIn["message_fit_in()"]
    TruncatedMsgs["Truncated Messages"]
    ChatModel["chat_mdl.async_chat_streamly_delta()"]
    StreamAnswer["Streaming Answer"]
    CheckCitation["quote enabled?"]
    InsertCitations["insert_citations()"]
    FinalAnswer["Final Answer"]

    Chunks --&gt; KbPrompt
    KbPrompt --&gt; FormatContext
    FormatContext --&gt; SystemPrompt
    Messages --&gt; MsgFitIn
    MsgFitIn --&gt; TruncatedMsgs
    SystemPrompt --&gt; ChatModel
    TruncatedMsgs --&gt; ChatModel
    ChatModel --&gt; StreamAnswer
    StreamAnswer --&gt; CheckCitation
    CheckCitation --&gt; InsertCitations
    CheckCitation --&gt; FinalAnswer
    InsertCitations --&gt; FinalAnswer</code></pre>
<strong>Response Generation Pipeline</strong></p>
<h3 id="context-formatting">Context Formatting<a class="headerlink" href="#context-formatting" title="Permanent link">&para;</a></h3>
<p>The <code>kb_prompt()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a>) formats chunks into context:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a># From api/db/services/dialog_service.py:448
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>knowledges = kb_prompt(kbinfos, max_tokens)
</code></pre></div>
-   Concatenates chunk contents with separators
-   Respects <code>max_tokens</code> limit from LLM configuration
-   Returns list of knowledge snippets</p>
<h3 id="message-fitting">Message Fitting<a class="headerlink" href="#message-fitting" title="Permanent link">&para;</a></h3>
<p>The <code>message_fit_in()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a>) ensures messages fit in context window (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L466-L466">api/db/services/dialog_service.py466</a>):</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>used_token_count, msg = message_fit_in(msg, int(max_tokens * 0.95))
</code></pre></div>
-   Truncates older messages if needed
-   Preserves system prompt and latest user message
-   Returns token count and truncated message list</p>
<h3 id="system-prompt-construction">System Prompt Construction<a class="headerlink" href="#system-prompt-construction" title="Permanent link">&para;</a></h3>
<p>The system prompt includes formatted knowledge (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L461-L461">api/db/services/dialog_service.py461</a>):</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>msg = [{&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: prompt_config[&quot;system&quot;].format(**kwargs)+attachments_}]
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>kwargs[&quot;knowledge&quot;] = &quot;\n------\n&quot; + &quot;\n\n------\n\n&quot;.join(knowledges)
</code></pre></div>
-   <code>prompt_config["system"]</code> is a template with <code>{knowledge}</code> placeholder
-   <code>kwargs</code> contains formatted knowledge sections
-   Attachments (files) appended to system message</p>
<h3 id="streaming-response">Streaming Response<a class="headerlink" href="#streaming-response" title="Permanent link">&para;</a></h3>
<p>The LLM call uses async streaming (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L558-L558">api/db/services/dialog_service.py558</a>):</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>stream_iter = chat_mdl.async_chat_streamly_delta(prompt + prompt4citation, msg[1:], gen_conf)
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>async for kind, value, state in _stream_with_think_delta(stream_iter):
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    yield {&quot;answer&quot;: value, &quot;reference&quot;: {}, &quot;audio_binary&quot;: tts(tts_mdl, value), &quot;final&quot;: False}
</code></pre></div>
-   Streams response tokens incrementally
-   <code>_stream_with_think_delta()</code> handles <code>&lt;think&gt;</code> reasoning blocks
-   TTS converts text to speech if enabled</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L448-L580">api/db/services/dialog_service.py448-580</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a></p>
<h2 id="citation-insertion-mechanism">Citation Insertion Mechanism<a class="headerlink" href="#citation-insertion-mechanism" title="Permanent link">&para;</a></h2>
<p>RAGFlow automatically inserts citations into generated answers:</p>
<p><pre class="mermaid"><code>flowchart TD
    Answer["Generated Answer"]
    CheckQuote["quote enabled?"]
    NoRef["Return answer as-is"]
    CheckVec["Has embd_mdl?"]
    AutoInsert["insert_citations()"]
    ParseID["Parse [ID:n] patterns"]
    EmbedSentences["Embed answer sentences"]
    MatchChunks["Match to chunk vectors"]
    InsertMarkers["Insert [ID:n] markers"]
    RepairBad["repair_bad_citation_formats()"]
    FilterRefs["Filter doc_aggs"]
    FinalAnswer["Answer with citations"]

    Answer --&gt; CheckQuote
    CheckQuote --&gt; NoRef
    CheckQuote --&gt; CheckVec
    CheckVec --&gt; AutoInsert
    CheckVec --&gt; ParseID
    AutoInsert --&gt; EmbedSentences
    EmbedSentences --&gt; MatchChunks
    MatchChunks --&gt; InsertMarkers
    ParseID --&gt; InsertMarkers
    InsertMarkers --&gt; RepairBad
    RepairBad --&gt; FilterRefs
    FilterRefs --&gt; FinalAnswer</code></pre>
<strong>Citation Insertion Flow</strong></p>
<h3 id="automatic-citation-insertion">Automatic Citation Insertion<a class="headerlink" href="#automatic-citation-insertion" title="Permanent link">&para;</a></h3>
<p>If LLM doesn't generate citations, <code>insert_citations()</code> adds them (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L486-L493">api/db/services/dialog_service.py486-493</a>):</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>if embd_mdl and not re.search(r&quot;\[ID:([0-9]+)\]&quot;, answer):
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    answer, idx = retriever.insert_citations(
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>        answer,
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>        [ck[&quot;content_ltks&quot;] for ck in kbinfos[&quot;chunks&quot;]],
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>        [ck[&quot;vector&quot;] for ck in kbinfos[&quot;chunks&quot;]],
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>        embd_mdl,
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>        tkweight=1 - dialog.vector_similarity_weight,
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>        vtweight=dialog.vector_similarity_weight,
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    )
</code></pre></div>
The <code>insert_citations()</code> method (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L178-L266">rag/nlp/search.py178-266</a>):</p>
<ol>
<li>
<p><strong>Sentence Splitting</strong>: Splits answer using regex patterns:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>r&quot;([^\|][；。？!！\n]|[a-z][.?;!][ \n])&quot;
</code></pre></div>
</li>
<li>
<p><strong>Sentence Embedding</strong>: Encodes each sentence with <code>embd_mdl.encode(pieces_)</code></p>
</li>
<li>
<p><strong>Similarity Computation</strong>: Calculates hybrid similarity between sentences and chunks:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sim, tksim, vtsim = self.qryr.hybrid_similarity(
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    ans_v[i], chunk_v,
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    sentence_tokens, chunks_tks,
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    tkweight, vtweight
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>)
</code></pre></div>
</li>
<li>
<p><strong>Citation Insertion</strong>: For sentences with similarity &gt; threshold, inserts <code>[ID:n]</code> markers</p>
</li>
<li>
<p><strong>Threshold Adaptation</strong>: Starts at 0.63, decreases to 0.3 if no citations found</p>
</li>
</ol>
<h3 id="manual-citation-parsing">Manual Citation Parsing<a class="headerlink" href="#manual-citation-parsing" title="Permanent link">&para;</a></h3>
<p>If LLM generates <code>[ID:n]</code> patterns (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L495-L498">api/db/services/dialog_service.py495-498</a>):</p>
<ul>
<li>Extracts all IDs using regex: <code>r"\[ID:([0-9]+)\]"</code></li>
<li>Validates IDs are within chunk list bounds</li>
</ul>
<h3 id="bad-format-repair">Bad Format Repair<a class="headerlink" href="#bad-format-repair" title="Permanent link">&para;</a></h3>
<p>The <code>repair_bad_citation_formats()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L246-L272">api/db/services/dialog_service.py246-272</a>) handles incorrect citation formats:</p>
<p>Recognized patterns:</p>
<ul>
<li><code>(ID: 12)</code> or <code>(ID:12)</code></li>
<li><code>[ID: 12]</code> without brackets</li>
<li><code>【ID: 12】</code> (Chinese brackets)</li>
<li><code>ref12</code> or <code>REF 12</code></li>
</ul>
<p>All converted to standard <code>[ID:n]</code> format.</p>
<h3 id="reference-filtering">Reference Filtering<a class="headerlink" href="#reference-filtering" title="Permanent link">&para;</a></h3>
<p>Final step filters <code>doc_aggs</code> to cited documents (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L502-L506">api/db/services/dialog_service.py502-506</a>):</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>idx = set([kbinfos[&quot;chunks&quot;][int(i)][&quot;doc_id&quot;] for i in idx])
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>recall_docs = [d for d in kbinfos[&quot;doc_aggs&quot;] if d[&quot;doc_id&quot;] in idx]
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>if not recall_docs:
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    recall_docs = kbinfos[&quot;doc_aggs&quot;]  # Fallback to all docs
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>kbinfos[&quot;doc_aggs&quot;] = recall_docs
</code></pre></div>
Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L178-L266">rag/nlp/search.py178-266</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L246-L506">api/db/services/dialog_service.py246-506</a></p>
<h2 id="citation-prompt-injection">Citation Prompt Injection<a class="headerlink" href="#citation-prompt-injection" title="Permanent link">&para;</a></h2>
<p>When citations are enabled, a special prompt instructs the LLM:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a># From api/db/services/dialog_service.py:463-464
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>prompt4citation = &quot;&quot;
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>if knowledges and (prompt_config.get(&quot;quote&quot;, True) and kwargs.get(&quot;quote&quot;, True)):
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    prompt4citation = citation_prompt()
</code></pre></div>
The <code>citation_prompt()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a>) returns:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>When answering questions, always cite the source using [ID:n] where n is the chunk ID.
</code></pre></div>
This is appended to the system prompt before sending to the LLM.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L463-L464">api/db/services/dialog_service.py463-464</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a></p>
<h2 id="toc-enhancement-for-long-documents">TOC Enhancement for Long Documents<a class="headerlink" href="#toc-enhancement-for-long-documents" title="Permanent link">&para;</a></h2>
<p>For documents with table of contents, an additional retrieval layer improves results:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a># From api/db/services/dialog_service.py:432-435
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>if prompt_config.get(&quot;toc_enhance&quot;):
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    cks = await retriever.retrieval_by_toc(&quot; &quot;.join(questions), kbinfos[&quot;chunks&quot;], tenant_ids, chat_mdl, dialog.top_n)
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    if cks:
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>        kbinfos[&quot;chunks&quot;] = cks
</code></pre></div>
The <code>retrieval_by_toc()</code> method (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py">rag/nlp/search.py</a>) uses the <code>relevant_chunks_with_toc()</code> prompt to:</p>
<ol>
<li>Extract TOC structure from chunks</li>
<li>Identify relevant sections</li>
<li>Retrieve child chunks under those sections</li>
<li>Expand context beyond initial retrieval</li>
</ol>
<p>This addresses context loss from over-chunking in long documents.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L432-L435">api/db/services/dialog_service.py432-435</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py">rag/nlp/search.py</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/prompts/generator.py">rag/prompts/generator.py</a></p>
<h2 id="parent-child-chunk-retrieval">Parent-Child Chunk Retrieval<a class="headerlink" href="#parent-child-chunk-retrieval" title="Permanent link">&para;</a></h2>
<p>After initial retrieval, the system can expand to include child chunks:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a># From api/db/services/dialog_service.py:436
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>kbinfos[&quot;chunks&quot;] = retriever.retrieval_by_children(kbinfos[&quot;chunks&quot;], tenant_ids)
</code></pre></div>
The <code>retrieval_by_children()</code> method (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L461-L475">rag/nlp/search.py461-475</a>):</p>
<ul>
<li>Checks each chunk for <code>mom_id</code> field (parent chunk ID)</li>
<li>If parent is not in results, fetches it from document store</li>
<li>Adds parent context to improve comprehension</li>
</ul>
<p>This implements parent-child chunking strategy where:</p>
<ul>
<li>Child chunks are indexed for precise retrieval</li>
<li>Parent chunks provide broader context when needed</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L461-L475">rag/nlp/search.py461-475</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L436-L436">api/db/services/dialog_service.py436</a></p>
<h2 id="knowledge-graph-integration">Knowledge Graph Integration<a class="headerlink" href="#knowledge-graph-integration" title="Permanent link">&para;</a></h2>
<p>For KB with knowledge graph enabled:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a># From api/db/services/dialog_service.py:442-446
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>if prompt_config.get(&quot;use_kg&quot;):
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    ck = await settings.kg_retriever.retrieval(
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>        &quot; &quot;.join(questions), tenant_ids, dialog.kb_ids, embd_mdl,
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>        LLMBundle(dialog.tenant_id, LLMType.CHAT)
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    )
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>    if ck[&quot;content_with_weight&quot;]:
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>        kbinfos[&quot;chunks&quot;].insert(0, ck)  # Prepend to chunks
</code></pre></div>
The KG retriever:</p>
<ul>
<li>Queries entity/relationship graph</li>
<li>Extracts relevant subgraphs</li>
<li>Converts to text format</li>
<li>Inserts at beginning of chunk list (highest priority)</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L442-L446">api/db/services/dialog_service.py442-446</a></p>
<h2 id="tavily-web-search-integration">Tavily Web Search Integration<a class="headerlink" href="#tavily-web-search-integration" title="Permanent link">&para;</a></h2>
<p>For queries requiring external information:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a># From api/db/services/dialog_service.py:437-441
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>if prompt_config.get(&quot;tavily_api_key&quot;):
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    tav = Tavily(prompt_config[&quot;tavily_api_key&quot;])
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    tav_res = tav.retrieve_chunks(&quot; &quot;.join(questions))
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    kbinfos[&quot;chunks&quot;].extend(tav_res[&quot;chunks&quot;])
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    kbinfos[&quot;doc_aggs&quot;].extend(tav_res[&quot;doc_aggs&quot;])
</code></pre></div>
Tavily integration:</p>
<ul>
<li>Searches web for current information</li>
<li>Returns chunks in same format as KB chunks</li>
<li>Appended to retrieval results</li>
<li>Enables RAG over internet + knowledge base</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L437-L441">api/db/services/dialog_service.py437-441</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/utils/tavily_conn.py">rag/utils/tavily_conn.py</a></p>
<h2 id="deep-reasoning-mode">Deep Reasoning Mode<a class="headerlink" href="#deep-reasoning-mode" title="Permanent link">&para;</a></h2>
<p>For complex queries requiring multi-step reasoning:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a># From api/db/services/dialog_service.py:380-413
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>if prompt_config.get(&quot;reasoning&quot;, False) or kwargs.get(&quot;reasoning&quot;):
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    reasoner = DeepResearcher(
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        chat_mdl, prompt_config,
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        partial(retriever.retrieval, embd_mdl=embd_mdl, ...)
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    )
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    await reasoner.research(kbinfos, questions[-1], questions[-1], callback=callback)
</code></pre></div>
The <code>DeepResearcher</code> class (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/advanced_rag.py">rag/advanced_rag.py</a>):</p>
<ol>
<li><strong>Planning</strong>: Breaks query into sub-questions</li>
<li><strong>Retrieval</strong>: Retrieves for each sub-question</li>
<li><strong>Synthesis</strong>: Combines answers</li>
<li><strong>Reflection</strong>: Evaluates completeness</li>
<li><strong>Iteration</strong>: Repeats until satisfied</li>
</ol>
<p>Output streams through <code>&lt;START_DEEP_RESEARCH&gt;</code> and <code>&lt;END_DEEP_RESEARCH&gt;</code> markers, triggering UI to show/hide thinking process.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L380-L413">api/db/services/dialog_service.py380-413</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/advanced_rag.py">rag/advanced_rag.py</a></p>
<h2 id="sql-based-retrieval-for-structured-data">SQL-Based Retrieval for Structured Data<a class="headerlink" href="#sql-based-retrieval-for-structured-data" title="Permanent link">&para;</a></h2>
<p>For knowledge bases with field mappings, the system can use SQL queries:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a># From api/db/services/dialog_service.py:327-336
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>field_map = KnowledgebaseService.get_field_map(dialog.kb_ids)
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>if field_map:
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    ans = await use_sql(questions[-1], field_map, dialog.tenant_id, chat_mdl,
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>                       prompt_config.get(&quot;quote&quot;, True), dialog.kb_ids)
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    if ans and (ans.get(&quot;reference&quot;, {}).get(&quot;chunks&quot;) or ans.get(&quot;answer&quot;)):
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>        yield ans
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>        return
</code></pre></div>
The <code>use_sql()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L585-L731">api/db/services/dialog_service.py585-731</a>):</p>
<ol>
<li><strong>SQL Generation</strong>: Prompts LLM to write SQL based on field schema</li>
<li><strong>Dialect Selection</strong>: Generates Elasticsearch SQL or Infinity SQL</li>
<li><strong>Execution</strong>: Runs query via <code>settings.retriever.sql_retrieval()</code></li>
<li><strong>Error Retry</strong>: If query fails, provides error to LLM for correction</li>
<li><strong>Format</strong>: Returns results as chunks for consistent handling</li>
</ol>
<p>Supported for:</p>
<ul>
<li>Aggregate queries: <code>COUNT(*)</code>, <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code>, <code>MIN()</code></li>
<li>Filtering: <code>WHERE field = value</code></li>
<li>Grouping: <code>GROUP BY field</code></li>
<li>Ordering: <code>ORDER BY field</code></li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L327-L731">api/db/services/dialog_service.py327-731</a></p>
<h2 id="response-decoration-and-metadata">Response Decoration and Metadata<a class="headerlink" href="#response-decoration-and-metadata" title="Permanent link">&para;</a></h2>
<p>The <code>decorate_answer()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L473-L549">api/db/services/dialog_service.py473-549</a>) adds metadata to responses:</p>
<p><pre class="mermaid"><code>flowchart TD
    RawAnswer["Raw LLM Answer"]
    ExtractThink["Extract think blocks"]
    ApplyCitations["Apply citations"]
    CheckErrors["Check for API errors"]
    AddTimings["Add timing info"]
    TokenCount["Count tokens"]
    Langfuse["Log to Langfuse"]
    FinalResponse["Final Response"]

    RawAnswer --&gt; ExtractThink
    ExtractThink --&gt; ApplyCitations
    ApplyCitations --&gt; CheckErrors
    CheckErrors --&gt; AddTimings
    AddTimings --&gt; TokenCount
    TokenCount --&gt; Langfuse
    Langfuse --&gt; FinalResponse</code></pre>
<strong>Response Decoration Flow</strong></p>
<p>Metadata added:</p>
<ul>
<li><strong>Time Elapsed</strong>: Breakdown of pipeline stages (ms)<ul>
<li>Check LLM</li>
<li>Bind models</li>
<li>Query refinement</li>
<li>Retrieval</li>
<li>Generate answer</li>
</ul>
</li>
<li><strong>Token Usage</strong>: Approximate token count</li>
<li><strong>Token Speed</strong>: Tokens per second</li>
<li><strong>Prompt</strong>: Full prompt used (for debugging)</li>
<li><strong>Reference</strong>: Filtered chunk/document references</li>
<li><strong>Created At</strong>: Timestamp</li>
</ul>
<p>Example timing output:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>## Time elapsed:
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>  - Total: 2453.2ms
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>  - Check LLM: 12.3ms
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>  - Bind models: 45.1ms
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>  - Query refinement(LLM): 234.5ms
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>  - Retrieval: 567.8ms
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>  - Generate answer: 1593.5ms
</code></pre></div>
Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L473-L549">api/db/services/dialog_service.py473-549</a></p>
<h2 id="metadata-based-filtering">Metadata-Based Filtering<a class="headerlink" href="#metadata-based-filtering" title="Permanent link">&para;</a></h2>
<p>The system supports filtering chunks by metadata conditions:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a># From api/apps/sdk/session.py:276-290
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>metadata_condition = extra_body.get(&quot;metadata_condition&quot;) or {}
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>if metadata_condition:
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    metas = DocumentService.get_meta_by_kbs(dia.kb_ids or [])
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    filtered_doc_ids = meta_filter(
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>        metas,
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>        convert_conditions(metadata_condition),
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>        metadata_condition.get(&quot;logic&quot;, &quot;and&quot;),
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    )
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>    if metadata_condition.get(&quot;conditions&quot;) and not filtered_doc_ids:
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>        filtered_doc_ids = [&quot;-999&quot;]  # No matches
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>    doc_ids_str = &quot;,&quot;.join(filtered_doc_ids) if filtered_doc_ids else None
</code></pre></div>
Metadata condition format:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>{
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>  &quot;logic&quot;: &quot;and&quot;,
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>  &quot;conditions&quot;: [
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    {&quot;name&quot;: &quot;author&quot;, &quot;comparison_operator&quot;: &quot;is&quot;, &quot;value&quot;: &quot;bob&quot;},
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    {&quot;name&quot;: &quot;year&quot;, &quot;comparison_operator&quot;: &quot;&gt;=&quot;, &quot;value&quot;: &quot;2020&quot;}
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>  ]
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>}
</code></pre></div>
Supported operators:</p>
<ul>
<li><code>is</code>: Exact match</li>
<li><code>is_not</code>: Not equal</li>
<li><code>contains</code>: Substring match</li>
<li><code>&gt;=</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&lt;</code>: Numeric comparison</li>
</ul>
<p>The <code>meta_filter()</code> function (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/common/metadata_utils.py">common/metadata_utils.py</a>) converts conditions to document ID sets using inverted index.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/session.py#L276-L290">api/apps/sdk/session.py276-290</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/common/metadata_utils.py">common/metadata_utils.py</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L357-L365">api/db/services/dialog_service.py357-365</a></p>
<h2 id="embedding-generation-during-retrieval">Embedding Generation During Retrieval<a class="headerlink" href="#embedding-generation-during-retrieval" title="Permanent link">&para;</a></h2>
<p>Embeddings are generated on-demand during query processing:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a># From rag/nlp/search.py:53-61
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>async def get_vector(self, txt, emb_mdl, topk=10, similarity=0.1):
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>    qv, _ = await thread_pool_exec(emb_mdl.encode_queries, txt)
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>    shape = np.array(qv).shape
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>    if len(shape) &gt; 1:
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>        raise Exception(&quot;Dealer.get_vector returned array&#39;s shape doesn&#39;t match expectation&quot;)
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>    embedding_data = [get_float(v) for v in qv]
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>    vector_column_name = f&quot;q_{len(embedding_data)}_vec&quot;
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>    return MatchDenseExpr(vector_column_name, embedding_data, &#39;float&#39;, &#39;cosine&#39;, topk, {&quot;similarity&quot;: similarity})
</code></pre></div>
The embedding model:</p>
<ul>
<li>Retrieved via <code>get_models()</code> (<a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L213-L235">api/db/services/dialog_service.py213-235</a>)</li>
<li>Must match KB's configured <code>embd_id</code></li>
<li>Cached per tenant in <code>LLMBundle</code></li>
<li>Executed in thread pool to avoid blocking</li>
</ul>
<p>Vector column naming:</p>
<ul>
<li>Format: <code>q_{dimension}_vec</code></li>
<li>Example: <code>q_1024_vec</code> for 1024-dimensional embeddings</li>
<li>Matches indexed chunk field names</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L53-L61">rag/nlp/search.py53-61</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L213-L235">api/db/services/dialog_service.py213-235</a></p>
<h2 id="empty-response-handling">Empty Response Handling<a class="headerlink" href="#empty-response-handling" title="Permanent link">&para;</a></h2>
<p>When no knowledge is retrieved:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a># From api/db/services/dialog_service.py:452-456
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>if not knowledges and prompt_config.get(&quot;empty_response&quot;):
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>    empty_res = prompt_config[&quot;empty_response&quot;]
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>    yield {&quot;answer&quot;: empty_res, &quot;reference&quot;: kbinfos, &quot;prompt&quot;: &quot;\n\n### Query:\n%s&quot; % &quot; &quot;.join(questions),
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>           &quot;audio_binary&quot;: tts(tts_mdl, empty_res), &quot;final&quot;: True}
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    return
</code></pre></div>
Configurable empty response message, typically:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>&quot;I apologize, but I couldn&#39;t find any relevant information in the knowledge base to answer your question.&quot;
</code></pre></div>
Prevents LLM from hallucinating when no context available.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L452-L456">api/db/services/dialog_service.py452-456</a></p>
<h2 id="openai-compatible-api-response-format">OpenAI-Compatible API Response Format<a class="headerlink" href="#openai-compatible-api-response-format" title="Permanent link">&para;</a></h2>
<p>The <code>/v1/chats_openai/{chat_id}/chat/completions</code> endpoint returns OpenAI-formatted responses:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a># From api/apps/sdk/session.py:318-387
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>response = {
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    &quot;id&quot;: f&quot;chatcmpl-{chat_id}&quot;,
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    &quot;choices&quot;: [{
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>        &quot;delta&quot;: {
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>            &quot;content&quot;: value,
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>            &quot;role&quot;: &quot;assistant&quot;,
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>            &quot;reasoning_content&quot;: None,
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>        },
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>        &quot;finish_reason&quot;: None,
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>        &quot;index&quot;: 0,
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>    }],
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>    &quot;created&quot;: int(time.time()),
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>    &quot;model&quot;: &quot;model&quot;,
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>    &quot;object&quot;: &quot;chat.completion.chunk&quot;,
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>    &quot;usage&quot;: None,
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>}
</code></pre></div>
Streaming format:</p>
<ul>
<li>Multiple <code>data:</code> events with incremental content</li>
<li><code>finish_reason: "stop"</code> in final chunk</li>
<li><code>usage</code> field only in last chunk</li>
<li><code>data:[DONE]</code> terminator</li>
</ul>
<p>Non-streaming format:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>{
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>  &quot;choices&quot;: [{
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    &quot;message&quot;: {
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>      &quot;role&quot;: &quot;assistant&quot;,
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>      &quot;content&quot;: &quot;...&quot;,
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>      &quot;reference&quot;: {...}
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>    },
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>    &quot;finish_reason&quot;: &quot;stop&quot;
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>  }],
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>  &quot;usage&quot;: {
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>    &quot;prompt_tokens&quot;: 100,
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>    &quot;completion_tokens&quot;: 200,
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>    &quot;total_tokens&quot;: 300
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>  }
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>}
</code></pre></div>
Reference field added when <code>extra_body.reference = true</code>.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/sdk/session.py#L180-L436">api/apps/sdk/session.py180-436</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/docs/references/http_api_reference.md#L34-L175">docs/references/http_api_reference.md34-175</a></p>
<h2 id="chunk-data-structure">Chunk Data Structure<a class="headerlink" href="#chunk-data-structure" title="Permanent link">&para;</a></h2>
<p>Retrieved chunks have the following structure:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>{
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>    &quot;id&quot;: &quot;chunk_id_hash&quot;,
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    &quot;content_with_weight&quot;: &quot;Full chunk text...&quot;,
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>    &quot;content_ltks&quot;: &quot;tokenized content&quot;,
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>    &quot;doc_id&quot;: &quot;document_id&quot;,
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>    &quot;docnm_kwd&quot;: &quot;Document name&quot;,
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>    &quot;kb_id&quot;: [&quot;dataset_id&quot;],
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>    &quot;important_kwd&quot;: [&quot;keyword1&quot;, &quot;keyword2&quot;],
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>    &quot;question_kwd&quot;: [&quot;question1?&quot;, &quot;question2?&quot;],
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>    &quot;img_id&quot;: &quot;image_chunk_id&quot;,
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>    &quot;page_num_int&quot;: [1, 2],
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>    &quot;position_int&quot;: [[x, y, w, h, page]],
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>    &quot;vector&quot;: [0.1, 0.2, ...],  # Embedding vector
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>    &quot;create_timestamp_flt&quot;: 1234567890.0,
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>    &quot;available_int&quot;: 1,  # 1=active, 0=disabled
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>    &quot;pagerank_int&quot;: 50,  # 0-100
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>    &quot;tag_dict&quot;: {&quot;tag1&quot;: 0.9, &quot;tag2&quot;: 0.7}
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a>}
</code></pre></div>
Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L92-L96">rag/nlp/search.py92-96</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/task_executor.py#L290-L338">rag/svr/task_executor.py290-338</a></p>
<h2 id="document-aggregation-structure">Document Aggregation Structure<a class="headerlink" href="#document-aggregation-structure" title="Permanent link">&para;</a></h2>
<p>The <code>doc_aggs</code> field contains document-level summaries:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>{
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>    &quot;doc_id&quot;: &quot;document_id&quot;,
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>    &quot;doc_name&quot;: &quot;Document.pdf&quot;,
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>    &quot;count&quot;: 5  # Number of chunks cited
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>}
</code></pre></div>
Used to display source documents in UI and track which documents contributed to the answer.</p>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/rag/nlp/search.py#L163-L163">rag/nlp/search.py163</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/dialog_service.py#L502-L506">api/db/services/dialog_service.py502-506</a></p>
<h2 id="integration-with-agent-system">Integration with Agent System<a class="headerlink" href="#integration-with-agent-system" title="Permanent link">&para;</a></h2>
<p>The RAG retrieval can be invoked from agent workflows via the <strong>Retrieval</strong> component:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a># From agent/tools/retrieval.py
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>class Retrieval(ComponentBase):
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    async def invoke_async(self, query: str):
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>        kbinfos = await settings.retriever.retrieval(
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>            query, embd_mdl, tenant_ids, kb_ids,
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>            page=1, page_size=top_n, ...
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>        )
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>        return kbinfos
</code></pre></div>
This allows agents to:</p>
<ul>
<li>Dynamically retrieve context during multi-step reasoning</li>
<li>Use retrieval as a tool in ReAct loops</li>
<li>Combine multiple knowledge bases</li>
</ul>
<p>Sources: <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/agent/tools/retrieval.py">agent/tools/retrieval.py</a> <a href="https://github.com/infiniflow/ragflow/blob/80a16e71/agent/component/retrieval.py">agent/component/retrieval.py</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>