# Supported Data Sources

Relevant source files

-   [api/apps/connector\_app.py](https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/connector_app.py)
-   [api/db/services/connector\_service.py](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py)
-   [api/utils/common.py](https://github.com/infiniflow/ragflow/blob/80a16e71/api/utils/common.py)
-   [common/constants.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/constants.py)
-   [common/data\_source/\_\_init\_\_.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/__init__.py)
-   [common/data\_source/config.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py)
-   [docker/docker-compose-base.yml](https://github.com/infiniflow/ragflow/blob/80a16e71/docker/docker-compose-base.yml)
-   [docker/infinity\_conf.toml](https://github.com/infiniflow/ragflow/blob/80a16e71/docker/infinity_conf.toml)
-   [helm/values.yaml](https://github.com/infiniflow/ragflow/blob/80a16e71/helm/values.yaml)
-   [pyproject.toml](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml)
-   [rag/svr/sync\_data\_source.py](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py)
-   [sdk/python/pyproject.toml](https://github.com/infiniflow/ragflow/blob/80a16e71/sdk/python/pyproject.toml)
-   [sdk/python/uv.lock](https://github.com/infiniflow/ragflow/blob/80a16e71/sdk/python/uv.lock)
-   [uv.lock](https://github.com/infiniflow/ragflow/blob/80a16e71/uv.lock)
-   [web/src/pages/user-setting/data-source/constant/index.tsx](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx)

This page documents the 20+ external data source connectors supported by RAGFlow for ingesting documents into knowledge bases. Each connector implements incremental synchronization, OAuth credential management (where applicable), and automatic scheduling capabilities.

For information about the synchronization architecture and scheduling system, see [Synchronization and Scheduling](/infiniflow/ragflow/7.2-synchronization-and-scheduling). For details on the connector framework and base classes, see [Connector Architecture](/infiniflow/ragflow/7.1-connector-architecture).

---

## Overview

RAGFlow supports connectors to cloud storage, collaboration platforms, email systems, cloud drives, development tools, and other data sources. All connectors extend the `SyncBase` abstract class defined in [rag/svr/sync\_data\_source.py77-183](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L77-L183) and implement either the `LoadConnector` or `PollConnector` interfaces from the common data source library.

**Supported Data Sources by Category:**

| Category | Connectors | `FileSource` Enum Values |
| --- | --- | --- |
| **Cloud Storage** | S3, R2 (Cloudflare), Google Cloud Storage, Oracle Cloud Storage | `S3`, `R2`, `GOOGLE_CLOUD_STORAGE`, `OCI_STORAGE` |
| **Collaboration** | Confluence, Notion, Discord, Slack\*, Teams\* | `CONFLUENCE`, `NOTION`, `DISCORD`, `SLACK`, `TEAMS` |
| **Email** | Gmail, IMAP | `GMAIL`, `IMAP` |
| **Cloud Drives** | Google Drive, Dropbox, Box, WebDAV | `GOOGLE_DRIVE`, `DROPBOX`, `BOX`, `WEBDAV` |
| **Dev Tools** | GitHub, GitLab, Jira, Bitbucket | `GITHUB`, `GITLAB`, `JIRA`, `BITBUCKET` |
| **Other** | Moodle, Airtable, Asana, Zendesk, SharePoint\* | `MOODLE`, `AIRTABLE`, `ASANA`, `ZENDESK`, `SHAREPOINT` |

\* Slack, Teams, and SharePoint connectors exist in the codebase but are not fully exposed in the current UI.

Sources: [common/constants.py111-138](https://github.com/infiniflow/ragflow/blob/80a16e71/common/constants.py#L111-L138) [rag/svr/sync\_data\_source.py77-183](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L77-L183) [web/src/pages/user-setting/data-source/constant/index.tsx16-41](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L16-L41)

---

## Data Source Enumeration and Implementation Mapping

**Connector Class Hierarchy**

```mermaid
flowchart TD
    FileSource["FileSource StrEnum"]
    SyncBase["SyncBasecall()_run_task_logic()_generate()"]
    BlobBase["_BlobLikeBase:188-221"]
    S3["S3:224-226"]
    R2["R2:229-231"]
    OCI["OCI_STORAGE:234-236"]
    GCS["GOOGLE_CLOUD_STORAGE:239-241"]
    Confluence["Confluence:244-334"]
    Notion["Notion:337-353"]
    Discord["Discord:356-381"]
    Gmail["Gmail:384-445"]
    Dropbox["Dropbox:448-466"]
    GoogleDrive["GoogleDrive:469-554"]
    Jira["Jira:557-848"]
    BlobConn["BlobStorageConnector"]
    NotionConn["NotionConnector"]
    ConfConn["ConfluenceConnector"]
    GmailConn["GmailConnector"]
    GDriveConn["GoogleDriveConnector"]
    JiraConn["JiraConnector"]

    FileSource --> S3
    FileSource --> R2
    FileSource --> Confluence
    FileSource --> Gmail
    SyncBase --> BlobBase
    SyncBase --> Confluence
    SyncBase --> Notion
    SyncBase --> Discord
    SyncBase --> Gmail
    SyncBase --> Dropbox
    SyncBase --> GoogleDrive
    SyncBase --> Jira
    BlobBase --> S3
    BlobBase --> R2
    BlobBase --> OCI
    BlobBase --> GCS
    S3 --> BlobConn
    Confluence --> ConfConn
    Notion --> NotionConn
    Gmail --> GmailConn
    GoogleDrive --> GDriveConn
    Jira --> JiraConn
```
**Key Implementation Details:**

-   All sync service connectors extend `SyncBase` at [rag/svr/sync\_data\_source.py77-183](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L77-L183)
-   `SyncBase.__call__()` provides task execution wrapper with timeout and error handling
-   `SyncBase._run_task_logic()` implements the core document batch processing loop
-   `SyncBase._generate()` is abstract and must be implemented by subclasses
-   Blob-like connectors (S3, R2, GCS, OCI) share common logic via `_BlobLikeBase`
-   Each connector delegates to a corresponding class in `common/data_source/` for actual API interaction

Sources: [common/constants.py111-138](https://github.com/infiniflow/ragflow/blob/80a16e71/common/constants.py#L111-L138) [rag/svr/sync\_data\_source.py77-848](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L77-L848) [common/data\_source/\_\_init\_\_.py26-80](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/__init__.py#L26-L80)

---

## Cloud Storage Connectors

### S3 and S3-Compatible Storage

The S3 connector supports AWS S3 and S3-compatible storage services. It uses the `BlobStorageConnector` with `bucket_type="s3"`.

**Connector Class:** `S3` extends `_BlobLikeBase` at [rag/svr/sync\_data\_source.py224-226](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L224-L226)

**Configuration Fields:**

-   `bucket_name` (required): S3 bucket name
-   `prefix` (optional): Path prefix within bucket
-   `credentials.aws_access_key_id` (required): AWS access key
-   `credentials.aws_secret_access_key` (required): AWS secret key
-   `credentials.region` (required): AWS region
-   `credentials.endpoint_url` (optional): Custom S3 endpoint
-   `credentials.addressing_style` (optional): `virtual` or `path`

**Python Dependencies:** `mypy-boto3-s3==1.40.26`, `opendal>=0.45.0,<0.46.0`

Sources: [pyproject.toml63-70](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L63-L70) [rag/svr/sync\_data\_source.py224-226](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L224-L226) [web/src/pages/user-setting/data-source/constant/index.tsx277](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L277-L277)

### R2 (Cloudflare R2)

Uses the same `BlobStorageConnector` with `bucket_type="r2"` for Cloudflare R2 storage.

**Connector Class:** `R2` extends `_BlobLikeBase` at [rag/svr/sync\_data\_source.py229-231](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L229-L231)

**Configuration Fields:**

-   `bucket_name` (required)
-   `credentials.account_id` (required): Cloudflare account ID
-   `credentials.r2_access_key_id` (required)
-   `credentials.r2_secret_access_key` (required)

Sources: [rag/svr/sync\_data\_source.py229-231](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L229-L231) [web/src/pages/user-setting/data-source/constant/index.tsx251-276](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L251-L276)

### Oracle Cloud Storage (OCI)

**Connector Class:** `OCI_STORAGE` extends `_BlobLikeBase` at [rag/svr/sync\_data\_source.py234-236](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L234-L236)

**Configuration Fields:**

-   `bucket_name` (required)
-   `credentials.namespace` (required): OCI namespace
-   `credentials.region` (required): OCI region
-   `credentials.access_key_id` (required)
-   `credentials.secret_access_key` (required)

Sources: [rag/svr/sync\_data\_source.py234-236](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L234-L236) [web/src/pages/user-setting/data-source/constant/index.tsx219-250](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L219-L250)

### Google Cloud Storage

**Connector Class:** `GOOGLE_CLOUD_STORAGE` extends `_BlobLikeBase` at [rag/svr/sync\_data\_source.py239-241](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L239-L241)

**Configuration Fields:**

-   `bucket_name` (required)
-   `credentials.access_key_id` (required): GCS HMAC key ID
-   `credentials.secret_access_key` (required): GCS HMAC secret

Sources: [rag/svr/sync\_data\_source.py239-241](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L239-L241) [web/src/pages/user-setting/data-source/constant/index.tsx199-218](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L199-L218)

### Blob Storage Architecture

**Blob Storage Connector Implementation**

```mermaid
flowchart TD
    BlobBase["_BlobLikeBaseDEFAULT_BUCKET_TYPE_generate()"]
    S3Class["S3SOURCE_NAME='s3'bucket_type='s3'"]
    R2Class["R2SOURCE_NAME='r2'bucket_type='r2'"]
    OCIClass["OCI_STORAGESOURCE_NAME='oci_storage'bucket_type='oci_storage'"]
    GCSClass["GOOGLE_CLOUD_STORAGESOURCE_NAME='google_cloud_storage'bucket_type='google_cloud_storage'"]
    BlobConn["BlobStorageConnectorinit(bucket_type, bucket_name, prefix)load_credentials(credentials)load_from_state()poll_source(start, end)"]
    S3Backend["S3 via boto3"]
    R2Backend["R2 via S3-compatible"]
    GCSBackend["GCS via HMAC"]
    OCIBackend["OCI Object Storage"]

    S3Class --> BlobBase
    R2Class --> BlobBase
    OCIClass --> BlobBase
    GCSClass --> BlobBase
    BlobBase --> BlobConn
    BlobConn --> S3Backend
    BlobConn --> R2Backend
    BlobConn --> GCSBackend
    BlobConn --> OCIBackend
```
**Shared Logic in `_BlobLikeBase._generate()`:**

1.  Reads `bucket_type` from config (defaults to `DEFAULT_BUCKET_TYPE`)
2.  Instantiates `BlobStorageConnector` with bucket parameters
3.  Calls `load_credentials()` with credentials from config
4.  Chooses `load_from_state()` for full reindex or `poll_source()` for incremental
5.  Returns document batch generator

Sources: [rag/svr/sync\_data\_source.py185-241](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L185-L241) [common/data\_source/\_\_init\_\_.py26](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/__init__.py#L26-L26)

---

## Collaboration Platform Connectors

### Confluence

The Confluence connector supports both Confluence Cloud (using API tokens) and Confluence Server/Data Center (using username/password).

**Connector Class:** `Confluence` at [rag/svr/sync\_data\_source.py244-334](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L244-L334)

**Configuration Fields:**

-   `wiki_base` (required): Confluence base URL
-   `is_cloud` (required): `true` for Cloud, `false` for Server
-   `index_mode` (required): One of `everything`, `space`, or `page`
-   `space` (required if `index_mode=space`): Space key
-   `page_id` (required if `index_mode=page`): Page ID
-   `index_recursively` (optional): Index child pages when `index_mode=page`
-   `credentials.confluence_username` (required)
-   `credentials.confluence_access_token` (required): API token (Cloud) or password (Server)

**Implementation Details:**

-   Uses `ConfluenceConnector` from [common/data\_source/confluence\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/confluence_connector.py)
-   Supports checkpointed loading with `CheckpointOutputWrapper`
-   Handles API failures gracefully with `CONTINUE_ON_CONNECTOR_FAILURE`
-   Configurable batch size via `sync_batch_size` or `batch_size` (defaults to `INDEX_BATCH_SIZE=2`)

**Python Dependencies:** `atlassian-python-api==4.0.7`

Sources: [pyproject.toml15](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L15-L15) [rag/svr/sync\_data\_source.py244-334](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L244-L334) [common/data\_source/config.py147-195](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L147-L195) [web/src/pages/user-setting/data-source/constant/index.tsx313](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L313-L313)

### Notion

**Connector Class:** `Notion` at [rag/svr/sync\_data\_source.py337-353](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L337-L353)

**Configuration Fields:**

-   `root_page_id` (optional): Root page to start indexing from
-   `credentials.notion_integration_token` (required): Notion integration token

**Implementation Details:**

-   Uses `NotionConnector` from [common/data\_source/notion\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/notion_connector.py)
-   Supports both full load (`load_from_state()`) and incremental polling (`poll_source()`)
-   Recursive page lookup can be disabled via `NOTION_CONNECTOR_DISABLE_RECURSIVE_PAGE_LOOKUP`

Sources: [rag/svr/sync\_data\_source.py337-353](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L337-L353) [common/data\_source/config.py119-131](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L119-L131) [web/src/pages/user-setting/data-source/constant/index.tsx278-291](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L278-L291)

### Discord

**Connector Class:** `Discord` at [rag/svr/sync\_data\_source.py356-381](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L356-L381)

**Configuration Fields:**

-   `server_ids` (optional): Comma-separated list of Discord server IDs
-   `channel_names` (optional): Comma-separated list of channel names
-   `batch_size` (optional): Batch size for message retrieval (default: 1024)
-   `credentials.discord_bot_token` (required): Discord bot token

**Implementation Details:**

-   Uses `DiscordConnector` from [common/data\_source/discord\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/discord_connector.py)
-   Indexes messages from specified servers and channels
-   Defaults to indexing from 1970-01-01 if no start date specified

**Python Dependencies:** `discord-py==2.3.2`

Sources: [pyproject.toml28](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L28-L28) [rag/svr/sync\_data\_source.py356-381](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L356-L381) [web/src/pages/user-setting/data-source/constant/index.tsx292-311](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L292-L311)

---

## Email Connectors

### Gmail

The Gmail connector supports Gmail and Google Workspace accounts using OAuth2 credentials with domain-wide delegation.

**Connector Class:** `Gmail` at [rag/svr/sync\_data\_source.py384-445](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L384-L445)

**Configuration Fields:**

-   `credentials.google_primary_admin` (required): Primary admin email for delegation
-   `credentials.google_tokens` (required): OAuth2 token JSON with service account
-   `credentials.authentication_method` (optional): Set to `uploaded`
-   `batch_size` (optional): Defaults to `INDEX_BATCH_SIZE=2`

**Implementation Details:**

-   Uses `GmailConnector` from [common/data\_source/gmail\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/gmail_connector.py)
-   Automatically refreshes and persists rotated OAuth credentials
-   Credential rotation logic at [rag/svr/sync\_data\_source.py402-418](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L402-L418)
-   Supports both full load and incremental polling by timestamp

**OAuth Flow:**

-   Uses service account with domain-wide delegation
-   Redirect URI configured via `GMAIL_WEB_OAUTH_REDIRECT_URI` env variable (default: `http://localhost:9380/v1/connector/gmail/oauth/web/callback`)

**Python Dependencies:** `google-auth-oauthlib>=1.2.0,<2.0.0`, `Office365-REST-Python-Client==2.6.2`

Sources: [pyproject.toml41-64](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L41-L64) [rag/svr/sync\_data\_source.py384-445](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L384-L445) [common/data\_source/config.py232](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L232-L232) [web/src/pages/user-setting/data-source/constant/index.tsx408-438](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L408-L438)

### IMAP

**Connector Class:** `Imap` at [rag/svr/sync\_data\_source.py848](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L848-L848) (referenced but not fully shown in provided snippet)

**Configuration Fields:**

-   `imap_host` (required): IMAP server hostname
-   `imap_port` (required): IMAP server port (typically 993)
-   `credentials.imap_username` (required)
-   `credentials.imap_password` (required)
-   `imap_mailbox` (optional): Array of mailbox names to index
-   `poll_range` (optional): Days to look back for emails

**Implementation Details:**

-   Uses `ImapConnector` from [common/data\_source/imap\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/imap_connector.py)
-   Supports standard IMAP protocol for email retrieval

Sources: [common/data\_source/\_\_init\_\_.py40](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/__init__.py#L40-L40) [common/data\_source/config.py275-277](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L275-L277) [web/src/pages/user-setting/data-source/constant/index.tsx749-786](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L749-L786)

---

## Cloud Drive Connectors

### Google Drive

**Connector Class:** `GoogleDrive` at [rag/svr/sync\_data\_source.py469-554](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L469-L554)

**Configuration Fields:**

-   `credentials.google_primary_admin` (required): Primary admin email
-   `credentials.google_tokens` (required): OAuth2 token JSON
-   `credentials.authentication_method` (optional): Set to `uploaded`
-   `my_drive_emails` (required): Comma-separated emails to impersonate
-   `shared_folder_urls` (required): Comma-separated shared folder URLs
-   `include_my_drives` (optional): Include user My Drives (default: true)
-   `include_shared_drives` (optional): Include shared drives (default: false)
-   `include_files_shared_with_me` (optional): Include shared files (default: false)
-   `allow_images` (optional): Allow image files (default: false)
-   `shared_drive_urls` (optional): Shared drive URLs
-   `specific_user_emails` (optional): Override default user list
-   `batch_size` (optional): Defaults to `INDEX_BATCH_SIZE=2`

**Implementation Details:**

-   Uses `GoogleDriveConnector` from [common/data\_source/google\_drive/connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/google_drive/connector.py)
-   Supports checkpointed loading with retry logic
-   Automatically refreshes and persists OAuth credentials via `_persist_rotated_credentials()`
-   Size threshold: 10MB (configurable via `GOOGLE_DRIVE_CONNECTOR_SIZE_THRESHOLD`)

**OAuth Flow:**

-   Redirect URI: `GOOGLE_DRIVE_WEB_OAUTH_REDIRECT_URI` (default: `http://localhost:9380/v1/connector/google-drive/oauth/web/callback`)

**Python Dependencies:** `google-auth-oauthlib>=1.2.0,<2.0.0`, `Office365-REST-Python-Client==2.6.2`

Sources: [pyproject.toml41-64](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L41-L64) [rag/svr/sync\_data\_source.py469-554](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L469-L554) [common/data\_source/config.py196-232](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L196-L232) [web/src/pages/user-setting/data-source/constant/index.tsx314-407](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L314-L407)

### Dropbox

**Connector Class:** `Dropbox` at [rag/svr/sync\_data\_source.py448-466](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L448-L466)

**Configuration Fields:**

-   `credentials.dropbox_access_token` (required): Dropbox OAuth access token
-   `batch_size` (optional): Defaults to `INDEX_BATCH_SIZE=2`

**Implementation Details:**

-   Uses `DropboxConnector` from [common/data\_source/dropbox\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/dropbox_connector.py)
-   Supports full load and incremental polling

**Python Dependencies:** `dropbox==12.0.2`

Sources: [pyproject.toml29](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L29-L29) [rag/svr/sync\_data\_source.py448-466](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L448-L466) [web/src/pages/user-setting/data-source/constant/index.tsx583-598](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L583-L598)

### Box

**Connector Class:** `Box` at [rag/svr/sync\_data\_source.py557](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L557-L557) (referenced but not fully shown in provided snippet)

**Configuration Fields:**

-   `credentials.box_tokens` (required): OAuth token JSON containing `client_id`, `client_secret`, `redirect_uri`, and tokens
-   `folder_id` (optional): Root folder ID (defaults to `0` for root)

**Implementation Details:**

-   Uses `BoxConnector` from [common/data\_source/box\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/box_connector.py)
-   OAuth integration with Box SDK using `BoxOAuth` and `OAuthConfig`
-   Redirect URI: `BOX_WEB_OAUTH_REDIRECT_URI` (default: `http://localhost:9380/v1/connector/box/oauth/web/callback`)

**Python Dependencies:** `boxsdk>=10.1.0`

Sources: [pyproject.toml20](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L20-L20) [rag/svr/sync\_data\_source.py71](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L71-L71) [common/data\_source/config.py242](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L242-L242) [web/src/pages/user-setting/data-source/constant/index.tsx599-620](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L599-L620)

### WebDAV

**Connector Class:** `WebDAV` (implementation referenced at [rag/svr/sync\_data\_source.py60](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L60-L60))

**Configuration Fields:**

-   `base_url` (required): WebDAV server URL
-   `remote_path` (optional): Remote path (default: `/`)
-   `credentials.username` (required)
-   `credentials.password` (required)

**Implementation Details:**

-   Uses `WebDAVConnector` from [common/data\_source/webdav\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/webdav_connector.py)

**Python Dependencies:** `webdav4>=0.10.0,<0.11.0`

Sources: [pyproject.toml110](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L110-L110) [rag/svr/sync\_data\_source.py60](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L60-L60) [web/src/pages/user-setting/data-source/constant/index.tsx554-582](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L554-L582)

---

## Development Tool Connectors

### GitHub

**Connector Class:** `Github` (referenced but implementation in separate file)

**Configuration Fields:**

-   `repository_owner` (required): GitHub username or organization
-   `repository_name` (required): Repository name
-   `credentials.github_access_token` (required): GitHub personal access token
-   `include_pull_requests` (optional): Include PRs (default: false)
-   `include_issues` (optional): Include issues (default: false)

**Implementation Details:**

-   Uses `GithubConnector` from [common/data\_source/github/connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/github/connector.py)
-   Base URL configurable via `GITHUB_CONNECTOR_BASE_URL` env variable for GitHub Enterprise

**Python Dependencies:** `pygithub>=2.8.1`

Sources: [pyproject.toml152](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L152-L152) [rag/svr/sync\_data\_source.py64](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L64-L64) [common/data\_source/config.py244](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L244-L244) [web/src/pages/user-setting/data-source/constant/index.tsx715-748](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L715-L748)

### GitLab

**Connector Class:** `Gitlab` (referenced but implementation in separate file)

**Configuration Fields:**

-   `project_owner` (required): GitLab username or group
-   `project_name` (required): Project name
-   `gitlab_url` (required): GitLab instance URL (default: `https://gitlab.com`)
-   `credentials.gitlab_access_token` (required): GitLab personal access token
-   `include_mrs` (optional): Include merge requests (default: true)
-   `include_issues` (optional): Include issues (default: true)
-   `include_code_files` (optional): Include code files (default: true)

**Implementation Details:**

-   Uses `GitlabConnector` from [common/data\_source/gitlab\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/gitlab_connector.py)

**Python Dependencies:** `python-gitlab>=7.0.0`

Sources: [pyproject.toml154](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L154-L154) [rag/svr/sync\_data\_source.py65](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L65-L65) [web/src/pages/user-setting/data-source/constant/index.tsx641-688](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L641-L688)

### Jira

**Connector Class:** `Jira` at [rag/svr/sync\_data\_source.py557-848](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L557-L848)

**Configuration Fields:**

-   `base_url` (required): Jira base URL (e.g., `https://your-domain.atlassian.net`)
-   `project_key` (optional): Jira project key for filtering
-   `jql_query` (optional): Custom JQL query for advanced filtering
-   `batch_size` (optional): Defaults to `INDEX_BATCH_SIZE=2`
-   `include_comments` (optional): Index comments (default: true)
-   `include_attachments` (optional): Index attachments (default: false)
-   `attachment_size_limit` (optional): Max attachment size in bytes (default: 10MB)
-   `labels_to_skip` (optional): Array of labels to skip
-   `comment_email_blacklist` (optional): Array of emails to exclude from comments
-   `scoped_token` (optional): Use scoped token for Cloud (default: false)
-   `timezone_offset` (optional): Timezone offset for date queries
-   `credentials.jira_user_email` (required): User email (Cloud) or username (Server)
-   `credentials.jira_api_token` (optional): API token for Cloud
-   `credentials.jira_password` (optional): Password for Server

**Implementation Details:**

-   Uses `JiraConnector` from [common/data\_source/jira/connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/jira/connector.py)
-   Supports both Jira Cloud (API token) and Jira Server/Data Center (password)
-   Configurable timezone offset (defaults to system timezone)
-   Sync time buffer: 1 minute (configurable via `JIRA_SYNC_TIME_BUFFER_SECONDS`)

**Python Dependencies:** `jira==3.10.5`

Sources: [pyproject.toml51](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L51-L51) [rag/svr/sync\_data\_source.py557-848](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L557-L848) [common/data\_source/config.py200-226](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L200-L226) [web/src/pages/user-setting/data-source/constant/index.tsx454-553](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L454-L553)

### Bitbucket

**Connector Class:** `Bitbucket` (referenced but implementation in separate file)

**Configuration Fields:**

-   `workspace` (required): Bitbucket workspace name
-   `index_mode` (required): One of `workspace`, `repository`, or `project`
-   `repository_slugs` (optional): Comma-separated repository slugs if `index_mode=repository`
-   `projects` (optional): Comma-separated project keys if `index_mode=project`
-   `credentials.bitbucket_api_token` (required): Bitbucket app password

**Implementation Details:**

-   Uses `BitbucketConnector` from [common/data\_source/bitbucket/connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/bitbucket/connector.py)

Sources: [rag/svr/sync\_data\_source.py66](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L66-L66) [web/src/pages/user-setting/data-source/constant/index.tsx787-1085](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L787-L1085)

---

## Other Connectors

### Moodle

**Connector Class:** `Moodle` (referenced but implementation in separate file)

**Configuration Fields:**

-   `moodle_url` (required): Moodle instance URL
-   `credentials.moodle_token` (required): Moodle web service token

**Implementation Details:**

-   Uses `MoodleConnector` from [common/data\_source/moodle\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/moodle_connector.py)

**Python Dependencies:** `moodlepy>=0.23.0`

Sources: [pyproject.toml62](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L62-L62) [rag/svr/sync\_data\_source.py49](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L49-L49) [web/src/pages/user-setting/data-source/constant/index.tsx439-453](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L439-L453)

### Airtable

**Connector Class:** `Airtable` (referenced but implementation in separate file)

**Configuration Fields:**

-   `credentials.airtable_access_token` (required): Airtable personal access token
-   `base_id` (required): Airtable base ID
-   `table_name_or_id` (required): Table name or ID to index

**Implementation Details:**

-   Uses `AirtableConnector` from [common/data\_source/airtable\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/airtable_connector.py)
-   Size threshold: 10MB (configurable via `AIRTABLE_CONNECTOR_SIZE_THRESHOLD`)

**Python Dependencies:** `pyairtable>=3.3.0`

Sources: [pyproject.toml151](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L151-L151) [rag/svr/sync\_data\_source.py52](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L52-L52) [common/data\_source/config.py267-269](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L267-L269) [web/src/pages/user-setting/data-source/constant/index.tsx621-640](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L621-L640)

### Asana

**Connector Class:** `Asana` (referenced but implementation in separate file)

**Configuration Fields:**

-   `credentials.asana_api_token_secret` (required): Asana personal access token
-   `asana_workspace_id` (required): Asana workspace GID
-   `asana_project_ids` (optional): Comma-separated project GIDs
-   `asana_team_id` (optional): Team GID

**Implementation Details:**

-   Uses `AsanaConnector` from [common/data\_source/asana\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/asana_connector.py)
-   Size threshold: 10MB (configurable via `ASANA_CONNECTOR_SIZE_THRESHOLD`)

**Python Dependencies:** `asana>=5.2.2`

Sources: [pyproject.toml153](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L153-L153) [rag/svr/sync\_data\_source.py53](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L53-L53) [common/data\_source/config.py271-273](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L271-L273) [web/src/pages/user-setting/data-source/constant/index.tsx689-714](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L689-L714)

### Zendesk

**Connector Class:** `Zendesk` (referenced but implementation in separate file)

**Configuration Fields:**

-   `credentials.zendesk_subdomain` (required): Zendesk subdomain
-   `credentials.zendesk_email` (required): Zendesk user email
-   `credentials.zendesk_token` (required): Zendesk API token
-   `zendesk_content_type` (required): Either `articles` or `tickets`

**Implementation Details:**

-   Uses `ZendeskConnector` from [common/data\_source/zendesk\_connector.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/zendesk_connector.py)
-   Can skip articles with specific labels via `ZENDESK_CONNECTOR_SKIP_ARTICLE_LABELS`

**Python Dependencies:** Not explicitly listed but inferred from connector existence

Sources: [rag/svr/sync\_data\_source.py55](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L55-L55) [common/data\_source/config.py279-281](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L279-L281) [web/src/pages/user-setting/data-source/constant/index.tsx788-817](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L788-L817)

---

## Connector Configuration Architecture

**Configuration Flow from Frontend to Sync**

```mermaid
flowchart TD
    UI["index.tsx"]
    DataSourceKey["DataSourceKey enum:16-41"]
    FormFields["DataSourceFormFields:198-817"]
    FormBase["DataSourceFormBaseFields:172-197"]
    SetAPI["POST /connector/set:39-65"]
    GetAPI["GET /connector/:74-80"]
    LogsAPI["GET /connector//logs:83-88"]
    ConnectorTable["connector tableid, tenant_id, name, sourceinput_type, config, statusrefresh_freq, prune_freq, timeout_secs"]
    SyncLogsTable["sync_logs tableid, connector_id, kb_idstatus, poll_range_start, poll_range_endnew_docs_indexed, total_docs_indexed"]
    Connector2KbTable["connector2kb tableconnector_id, kb_id, auto_parse"]
    ConnectorService["ConnectorService:32-79save(), update_by_id()resume(), rebuild()"]
    SyncLogsService["SyncLogsService:81-244start(), done(), schedule()increase_docs(), duplicate_and_parse()"]
    Connector2KbService["Connector2KbService:246-300link_connectors(), list_connectors()"]
    SyncClasses["S3:224, Confluence:244Gmail:384, GoogleDrive:469Jira:557, etc."]
    SyncBase["SyncBase:77-183call(), _run_task_logic()"]

    UI --> DataSourceKey
    UI --> FormFields
    FormFields --> SetAPI
    SetAPI --> ConnectorService
    ConnectorService --> ConnectorTable
    ConnectorService --> Connector2KbService
    Connector2KbService --> Connector2KbTable
    ConnectorService --> SyncLogsService
    SyncLogsService --> SyncLogsTable
    SyncLogsTable --> SyncClasses
    SyncClasses --> SyncBase
    SyncBase --> SyncLogsService
```
**Configuration Storage Details:**

| Table | Key Fields | Purpose |
| --- | --- | --- |
| `connector` | `id`, `tenant_id`, `name`, `source`, `config`, `status` | Store connector metadata and configuration JSON |
| `sync_logs` | `connector_id`, `kb_id`, `status`, `poll_range_start`, `poll_range_end` | Track sync task execution and progress |
| `connector2kb` | `connector_id`, `kb_id`, `auto_parse` | Link connectors to knowledge bases |

**Configuration JSON Structure:**

```
{
    "bucket_name": "...",      # Connector-specific fields
    "credentials": {            # Nested credentials object
        "aws_access_key_id": "...",
        "aws_secret_access_key": "..."
    },
    "batch_size": 2,           # Optional sync parameters
    "sync_batch_size": 10
}
```
**Configuration Access in Sync Worker:**

-   Config loaded from task dict at [rag/svr/sync\_data\_source.py80-82](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L80-L82): `self.conf = conf`
-   Accessed via `self.conf["field_name"]` or `self.conf.get("field_name", default)`
-   Credentials accessed via `self.conf["credentials"]` or `self.conf.get("credentials")`

Sources: [rag/svr/sync\_data\_source.py80-82](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L80-L82) [api/apps/connector\_app.py39-65](https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/connector_app.py#L39-L65) [api/db/services/connector\_service.py32-303](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py#L32-L303) [web/src/pages/user-setting/data-source/constant/index.tsx16-817](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L16-L817)

---

## Credential Management and OAuth

```mermaid
flowchart TD
    GMAIL["Gmail"]
    GDRIVE["Google Drive"]
    BOX["Box"]
    LOAD["load_credentials()"]
    REFRESH["Token refresh logic"]
    PERSIST["ConnectorService.update_by_id()"]
    DB["connector.config.credentials"]
    JSON["OAuth token JSON"]

    GMAIL --> LOAD
    GDRIVE --> LOAD
    BOX --> LOAD
    LOAD --> REFRESH
    REFRESH --> PERSIST
    PERSIST --> DB
    DB --> JSON
```
**OAuth Implementation Details:**

1.  **Gmail/Google Drive OAuth:**

    -   Service account with domain-wide delegation
    -   Tokens stored in `config.credentials.google_tokens`
    -   Automatic refresh at [rag/svr/sync\_data\_source.py402-418](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L402-L418) (Gmail)
    -   Automatic refresh at [rag/svr/sync\_data\_source.py490-554](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L490-L554) (Google Drive)
2.  **Box OAuth:**

    -   Client credentials flow with refresh tokens
    -   Tokens stored in `config.credentials.box_tokens`
    -   Uses `BoxOAuth` from `box-sdk-gen` library
3.  **Credential Persistence:**

    -   After refresh, credentials are persisted via `ConnectorService.update_by_id()`
    -   Prevents credential expiration during sync

**Environment Variables for OAuth:**

-   `GMAIL_WEB_OAUTH_REDIRECT_URI`: Gmail OAuth callback (default: `http://localhost:9380/v1/connector/gmail/oauth/web/callback`)
-   `GOOGLE_DRIVE_WEB_OAUTH_REDIRECT_URI`: Google Drive OAuth callback
-   `BOX_WEB_OAUTH_REDIRECT_URI`: Box OAuth callback

Sources: [common/data\_source/config.py227-242](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L227-L242) [rag/svr/sync\_data\_source.py71-554](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L71-L554)

---

## Synchronization Task Flow

**Task Execution Sequence**

> **[Mermaid sequence]**
> *(图表结构无法解析)*

**Key Components:**

| Component | Location | Responsibility |
| --- | --- | --- |
| `SyncBase.__call__()` | [rag/svr/sync\_data\_source.py83-107](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L83-L107) | Task execution wrapper with timeout & error handling |
| `SyncBase._run_task_logic()` | [rag/svr/sync\_data\_source.py109-176](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L109-L176) | Core sync loop, batch processing |
| `SyncBase._generate()` | [rag/svr/sync\_data\_source.py178-179](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L178-L179) | Abstract method implemented by subclasses |
| `task_limiter` | [rag/svr/sync\_data\_source.py73-74](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L73-L74) | Semaphore(5) for concurrent task limiting |
| `hash128()` | [api/utils/common.py28-29](https://github.com/infiniflow/ragflow/blob/80a16e71/api/utils/common.py#L28-L29) | Document ID deduplication using xxhash.xxh128 |
| `SyncLogsService.start()` | [api/db/services/connector\_service.py140-142](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py#L140-L142) | Mark task as RUNNING |
| `SyncLogsService.increase_docs()` | [api/db/services/connector\_service.py185-195](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py#L185-L195) | Update sync progress |
| `SyncLogsService.done()` | [api/db/services/connector\_service.py145-147](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py#L145-L147) | Mark task as DONE |
| `SyncLogsService.schedule()` | [api/db/services/connector\_service.py150-183](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py#L150-L183) | Schedule next sync task |

**Timeout and Error Handling:**

-   Global task timeout: `asyncio.wait_for(..., timeout=task["timeout_secs"])` at [rag/svr/sync\_data\_source.py88](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L88-L88)
-   Exception handling: Full traceback stored in `full_exception_trace` at [rag/svr/sync\_data\_source.py95-104](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L95-L104)
-   Batch failures: Logged but don't stop sync at [rag/svr/sync\_data\_source.py157-167](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L157-L167)

Sources: [rag/svr/sync\_data\_source.py73-176](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L73-L176) [api/db/services/connector\_service.py140-195](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py#L140-L195) [api/utils/common.py28-29](https://github.com/infiniflow/ragflow/blob/80a16e71/api/utils/common.py#L28-L29)

---

## Batch Processing and Checkpoints

Several connectors support checkpointed loading for handling large datasets:

**Checkpoint-Supporting Connectors:**

-   Confluence: [rag/svr/sync\_data\_source.py300-327](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L300-L327)
-   Google Drive: [rag/svr/sync\_data\_source.py510-537](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L510-L537)

**Checkpoint Architecture:**

```
# Pseudocode from Confluence connector
checkpoint = connector.build_dummy_checkpoint()
while checkpoint.has_more:
    wrapper = CheckpointOutputWrapper()
    doc_generator = wrapper(connector.load_from_checkpoint(start_time, end_time, checkpoint))
    for document, failure, next_checkpoint in doc_generator:
        if failure is not None:
            log_warning(failure)
        if document is not None:
            batch.append(document)
            if len(batch) >= batch_size:
                yield batch
                batch = []
        if next_checkpoint is not None:
            checkpoint = next_checkpoint
```
**Benefits:**

-   Handles API pagination transparently
-   Resumes from last checkpoint on failure
-   Prevents memory exhaustion on large datasets
-   Iteration limit prevents infinite loops (100,000 iterations max)

Sources: [rag/svr/sync\_data\_source.py300-544](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L300-L544) [common/data\_source/interfaces.py67](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/interfaces.py#L67-L67)

---

## Configuration Examples

### S3 Connector Configuration

```
{
  "name": "My S3 Bucket",
  "source": "s3",
  "config": {
    "bucket_name": "my-documents",
    "bucket_type": "s3",
    "prefix": "public/",
    "credentials": {
      "aws_access_key_id": "AKIAIOSFODNN7EXAMPLE",
      "aws_secret_access_key": "wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY",
      "region": "us-west-2",
      "authentication_method": "access_key"
    }
  }
}
```
### Confluence Connector Configuration

```
{
  "name": "Company Wiki",
  "source": "confluence",
  "config": {
    "wiki_base": "https://company.atlassian.net/wiki",
    "is_cloud": true,
    "index_mode": "space",
    "space": "TEAM",
    "sync_batch_size": 10,
    "credentials": {
      "confluence_username": "user@company.com",
      "confluence_access_token": "ATATTxxx..."
    }
  }
}
```
### Google Drive Connector Configuration

```
{
  "name": "Company Drive",
  "source": "google_drive",
  "config": {
    "my_drive_emails": "user1@company.com,user2@company.com",
    "shared_folder_urls": "https://drive.google.com/drive/folders/1ABC...,https://drive.google.com/drive/folders/2DEF...",
    "include_my_drives": true,
    "batch_size": 5,
    "credentials": {
      "google_primary_admin": "admin@company.com",
      "google_tokens": "{\"type\":\"service_account\",\"project_id\":\"...\",\"private_key\":\"...\"}",
      "authentication_method": "uploaded"
    }
  }
}
```
### Jira Connector Configuration

```
{
  "name": "Project Tracker",
  "source": "jira",
  "config": {
    "base_url": "https://company.atlassian.net",
    "project_key": "PROJ",
    "include_comments": true,
    "include_attachments": false,
    "batch_size": 2,
    "credentials": {
      "jira_user_email": "user@company.com",
      "jira_api_token": "ATATTxxx..."
    }
  }
}
```
Sources: [web/src/pages/user-setting/data-source/constant/index.tsx820-1099](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx#L820-L1099)

---

## Environment Configuration

Key environment variables affecting connector behavior:

| Variable | Default | Description |
| --- | --- | --- |
| `MAX_CONCURRENT_TASKS` | `5` | Max concurrent sync tasks |
| `REQUEST_TIMEOUT_SECONDS` | `60` | HTTP request timeout |
| `CONTINUE_ON_CONNECTOR_FAILURE` | `true` | Continue on API failures |
| `CONFLUENCE_TIMEZONE_OFFSET` | System TZ | Confluence CQL timezone offset |
| `CONFLUENCE_SYNC_TIME_BUFFER_SECONDS` | `86400` | Confluence sync buffer (1 day) |
| `GOOGLE_DRIVE_CONNECTOR_SIZE_THRESHOLD` | `10485760` | Max file size (10MB) |
| `JIRA_TIMEZONE_OFFSET` | System TZ | Jira JQL timezone offset |
| `JIRA_SYNC_TIME_BUFFER_SECONDS` | `60` | Jira sync buffer (1 minute) |
| `GITHUB_CONNECTOR_BASE_URL` | None | GitHub Enterprise URL |
| `NOTION_CONNECTOR_DISABLE_RECURSIVE_PAGE_LOOKUP` | `false` | Disable recursive pages |

Sources: [rag/svr/sync\_data\_source.py73](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L73-L73) [common/data\_source/config.py17-244](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L17-L244)

---

## Error Handling and Resilience

**Timeout Handling:**

-   Global task timeout enforced via `asyncio.wait_for()` at [rag/svr/sync\_data\_source.py88](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L88-L88)
-   Timeout value from `task["timeout_secs"]`
-   On timeout, task marked as `FAIL` with error message

**Exception Handling:**

-   All exceptions caught and logged with full traceback at [rag/svr/sync\_data\_source.py95-104](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L95-L104)
-   Exception details stored in `full_exception_trace` field
-   Task marked as `FAIL` with error message

**Batch Failure Handling:**

-   Individual batch failures don't stop entire sync at [rag/svr/sync\_data\_source.py157-167](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L157-L167)
-   Collation errors specifically handled (MySQL charset issues)
-   Failed document count tracked separately

**Credential Expiration:**

-   OAuth connectors automatically refresh tokens
-   Refreshed credentials persisted back to database
-   Prevents mid-sync failures due to expired credentials

**Connector Failures:**

-   `CONTINUE_ON_CONNECTOR_FAILURE` allows skipping individual documents
-   Confluence and Google Drive use `CheckpointOutputWrapper` to handle failures gracefully
-   Warnings logged but sync continues

Sources: [rag/svr/sync\_data\_source.py83-176](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L83-L176) [common/data\_source/config.py138-140](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L138-L140)

---

## Summary Table

| Connector | OAuth | Incremental | Batch Size | Size Limit | Dependencies |
| --- | --- | --- | --- | --- | --- |
| S3 | No | Yes | N/A | N/A | boto3, opendal |
| R2 | No | Yes | N/A | N/A | boto3, opendal |
| GCS | No | Yes | N/A | N/A | opendal |
| OCI Storage | No | Yes | N/A | N/A | opendal |
| Confluence | No | Yes | 2 | 10MB | atlassian-python-api |
| Notion | No | Yes | N/A | N/A | \- |
| Discord | No | Yes | 1024 | N/A | discord-py |
| Gmail | Yes | Yes | 2 | N/A | google-auth-oauthlib |
| Google Drive | Yes | Yes | 2 | 10MB | google-auth-oauthlib |
| Dropbox | No | Yes | 2 | N/A | dropbox |
| Box | Yes | Yes | N/A | N/A | boxsdk |
| Jira | No | Yes | 2 | 10MB | jira |
| GitHub | No | Yes | N/A | N/A | pygithub |
| GitLab | No | Yes | N/A | N/A | python-gitlab |
| Bitbucket | No | Yes | N/A | N/A | \- |
| Moodle | No | Yes | N/A | N/A | moodlepy |
| WebDAV | No | Yes | N/A | N/A | webdav4 |
| Airtable | No | Yes | N/A | 10MB | pyairtable |
| Asana | No | Yes | N/A | 10MB | asana |
| IMAP | No | Yes | N/A | 10MB | \- |
| Zendesk | No | Yes | N/A | N/A | \- |

Sources: [pyproject.toml10-156](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml#L10-L156) [rag/svr/sync\_data\_source.py1-848](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py#L1-L848) [common/data\_source/config.py102-273](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py#L102-L273)
