# 7.3 支持的数据源 (Supported Data Sources)

相关源文件：

- [api/apps/connector_app.py](https://github.com/infiniflow/ragflow/blob/80a16e71/api/apps/connector_app.py)
- [api/db/services/connector_service.py](https://github.com/infiniflow/ragflow/blob/80a16e71/api/db/services/connector_service.py)
- [common/constants.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/constants.py)
- [common/data_source/__init__.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/__init__.py)
- [common/data_source/config.py](https://github.com/infiniflow/ragflow/blob/80a16e71/common/data_source/config.py)
- [pyproject.toml](https://github.com/infiniflow/ragflow/blob/80a16e71/pyproject.toml)
- [rag/svr/sync_data_source.py](https://github.com/infiniflow/ragflow/blob/80a16e71/rag/svr/sync_data_source.py)
- [web/src/pages/user-setting/data-source/constant/index.tsx](https://github.com/infiniflow/ragflow/blob/80a16e71/web/src/pages/user-setting/data-source/constant/index.tsx)

本页面详细介绍了 RAGFlow 支持的 20 多个外部数据源连接器。每个连接器都实现了增量同步、OAuth 凭据管理（如适用）以及自动调度功能。

## 概述 (Overview)

RAGFlow 支持连接到对象存储、协同平台、电子邮件系统、云盘、开发工具等。所有连接器都继承自 `SyncBase` 抽象类，并实现了全量加载 (`LoadConnector`) 或增量轮询 (`PollConnector`) 接口。

**按类别划分的数据源：**

| 类别 | 连接器 | `FileSource` 枚举值 |
| --- | --- | --- |
| **对象存储** | S3, R2 (Cloudflare), Google Cloud Storage, Oracle Cloud Storage | `S3`, `R2`, `GOOGLE_CLOUD_STORAGE`, `OCI_STORAGE` |
| **协同平台** | Confluence, Notion, Discord, Slack*, Teams* | `CONFLUENCE`, `NOTION`, `DISCORD`, `SLACK`, `TEAMS` |
| **电子邮件** | Gmail, IMAP | `GMAIL`, `IMAP` |
| **云盘/文件服务** | Google Drive, Dropbox, Box, WebDAV | `GOOGLE_DRIVE`, `DROPBOX`, `BOX`, `WEBDAV` |
| **开发工具** | GitHub, GitLab, Jira, Bitbucket | `GITHUB`, `GITLAB`, `JIRA`, `BITBUCKET` |
| **其他** | Moodle, Airtable, Asana, Zendesk, SharePoint* | `MOODLE`, `AIRTABLE`, `ASANA`, `ZENDESK`, `SHAREPOINT` |

*带有星号的项目在代码库中已存在，但尚未在 UI 中完全开放。

## 对象存储连接器 (Cloud Storage Connectors)

### S3 及兼容存储
支持 AWS S3 及其他兼容 S3 协议的存储服务。
-   **配置字段**：`bucket_name`、`prefix`、`access_key_id`、`secret_access_key`、`region`、`endpoint_url`。
-   **依赖项**：`boto3`, `opendal`。

### Cloudflare R2 / Oracle OCI / Google GCS
均使用统一的 `BlobStorageConnector` 实现，通过不同的 `bucket_type` 进行区分。

## 协同平台连接器 (Collaboration Platform Connectors)

### Confluence
支持 Confluence Cloud 和 Server/Data Center。
-   **配置字段**：`wiki_base`、`is_cloud`、`index_mode`（全量/空间/页面）、`space` 或 `page_id`、`credentials`。
-   **特性**：支持基于检查点（Checkpoint）的分页加载。

### Notion
-   **配置字段**：`root_page_id`（可选）、`notion_integration_token`。
-   **特性**：递归遍历页面层级（可通过环境变量禁用）。

### Discord
-   **配置字段**：`server_ids`、`channel_names`、`batch_size`、`discord_bot_token`。

## 电子邮件连接器 (Email Connectors)

### Gmail
使用 OAuth2 和全域代理权限。
-   **特性**：自动刷新并持久化 OAuth 令牌。

### IMAP
-   **配置字段**：`imap_host`、`imap_port`、`imap_username`、`imap_password`、`imap_mailbox`（文件夹列表）。

## 开发工具连接器 (Development Tool Connectors)

### Jira
支持 Jira Cloud 和 Server/Data Center。
-   **配置字段**：`base_url`、`project_key`、`jql_query`（自定义查询）、`include_comments`、`labels_to_skip`。

### GitHub / GitLab
-   **配置字段**：仓库所有者、仓库名称、访问令牌、是否包含 Issue/PR/MR。
-   **特性**：支持 GitHub Enterprise 自定义基础 URL。

## 配置与集成架构 (Configuration Architecture)

1.  **存储结构**：连接器配置存储在 `connector` 表的 `config` JSON 字段中。
2.  **映射关系**：前端表单 (`DataSourceFormFields`) 直接映射到后端的 JSON 路径。
3.  **日志与追踪**：`sync_logs` 表记录每次任务的状态、同步范围 (`poll_range_start/end`) 和索引进度。
4.  **凭据持久化**：对于 OAuth 连接器，刷新后的新令牌会立即通过 `ConnectorService.update_by_id()` 更新到数据库。

## 错误处理与弹性 (Error Handling and Resilience)

-   **超时处理**：通过 `asyncio.wait_for` 强制执行全局任务超时。
-   **批次容错**：单个批次的失败（如数据库排序规则冲突）不会中断整个同步任务。
-   **连接器失败**：`CONTINUE_ON_CONNECTOR_FAILURE` 允许跳过无法访问的单个文档。
-   **重试机制**：API 调用通常带有重试逻辑，特别是针对 Confluence 和 Google Drive。
