# Optional Dependencies

Relevant source files

-   [.github/workflows/integration-test.disabled](https://github.com/open-webui/open-webui/blob/a7271532/.github/workflows/integration-test.disabled)
-   [backend/open\_webui/storage/provider.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/storage/provider.py)
-   [backend/open\_webui/test/apps/webui/storage/test\_provider.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/test/apps/webui/storage/test_provider.py)
-   [backend/requirements-min.txt](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements-min.txt)
-   [backend/requirements.txt](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements.txt)
-   [docker-compose.playwright.yaml](https://github.com/open-webui/open-webui/blob/a7271532/docker-compose.playwright.yaml)
-   [pyproject.toml](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml)
-   [uv.lock](https://github.com/open-webui/open-webui/blob/a7271532/uv.lock)

## Purpose and Scope

This page documents the optional dependency system in Open WebUI's backend Python environment. Open WebUI uses a tiered dependency structure that allows users to install only the packages they need for their specific deployment scenario. This reduces installation size, avoids conflicts, and enables gradual feature adoption.

For information about the core required dependencies, see [Backend Dependencies](/open-webui/open-webui/16.1-websocket-architecture). For deployment-specific configuration, see [Installation and Setup](/open-webui/open-webui/17.1-backend-dependencies).

## Dependency Group Overview

Open WebUI defines its dependencies in `pyproject.toml` using PEP 621 optional dependency groups. The system provides three installation tiers:

```mermaid
flowchart TD
    Base["Base Installation(pip install open-webui)"]
    Postgres["PostgreSQL Group(pip install open-webui[postgres])"]
    All["All Features Group(pip install open-webui[all])"]
    CoreDeps["Core DependenciesFastAPI, SQLAlchemy, ChromaDB,OpenAI, Anthropic, etc."]
    PostgresDeps["psycopg2-binary==2.9.10pgvector==0.4.1"]
    AllDeps["Testing: pytest, docker, playwrightVector DBs: Qdrant, Milvus, PineconeSearch: Elasticsearch, FirecrawlEmulators: moto, gcp-storage-emulator"]

    Base --> CoreDeps
    Postgres --> PostgresDeps
    All --> AllDeps
    Base --> CoreDeps
    Postgres --> CoreDeps
    Postgres --> PostgresDeps
    All --> CoreDeps
    All --> PostgresDeps
    All --> AllDeps
```
**Sources:** [pyproject.toml131-158](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L131-L158) [backend/requirements.txt1-153](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements.txt#L1-L153)

## Optional Dependency Groups

### PostgreSQL Group (`postgres`)

The `postgres` optional dependency group adds support for PostgreSQL as the primary database backend, replacing the default SQLite.

| Package | Version | Purpose |
| --- | --- | --- |
| `psycopg2-binary` | 2.9.10 | PostgreSQL database adapter |
| `pgvector` | 0.4.1 | PostgreSQL extension for vector similarity search |

**Installation:**

```
pip install open-webui[postgres]
```
**Configuration Requirements:**

-   Set `DATABASE_URL` environment variable to PostgreSQL connection string
-   Example: `postgresql://user:password@localhost:5432/openwebui`
-   Supports connection pooling via SQLAlchemy pool parameters

**Sources:** [pyproject.toml132-135](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L132-L135) [.github/workflows/integration-test.disabled181-209](https://github.com/open-webui/open-webui/blob/a7271532/.github/workflows/integration-test.disabled#L181-L209)

### All Features Group (`all`)

The `all` optional dependency group includes every optional feature for development, testing, and advanced deployments. This group is primarily intended for:

-   Development environments
-   Comprehensive testing suites
-   Deployments requiring multiple vector databases
-   Advanced search and document processing capabilities

#### Testing and Development Dependencies

| Package | Version | Purpose |
| --- | --- | --- |
| `docker` | ~7.1.0 | Docker container orchestration for tests |
| `pytest` | ~8.3.2 | Testing framework |
| `pytest-docker` | ~3.2.5 | Docker fixtures for pytest |
| `moto[s3]` | \>=5.0.26 | AWS S3 service emulator |
| `gcp-storage-emulator` | \>=2024.8.3 | Google Cloud Storage emulator |

#### Additional Vector Databases

| Package | Version | Purpose |
| --- | --- | --- |
| `qdrant-client` | 1.14.3 | Qdrant vector database client |
| `pymilvus` | 2.6.4 | Milvus vector database client |
| `pinecone` | 6.0.2 | Pinecone cloud vector database |
| `oracledb` | 3.2.0 | Oracle Database connectivity |

Note: ChromaDB, Weaviate, and OpenSearch are included in the base installation.

#### Search and Document Processing

| Package | Version | Purpose |
| --- | --- | --- |
| `elasticsearch` | 9.1.0 | Elasticsearch client for search |
| `firecrawl-py` | 4.10.0 | Web scraping and crawling |
| `azure-search-documents` | 11.6.0 | Azure Cognitive Search integration |
| `playwright` | 1.56.0 | Browser automation for web scraping |

#### Advanced Retrieval

| Package | Version | Purpose |
| --- | --- | --- |
| `colbert-ai` | 0.2.21 | ColBERT reranking model support |

**Installation:**

```
pip install open-webui[all]
```
**Sources:** [pyproject.toml137-158](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L137-L158) [backend/open\_webui/test/apps/webui/storage/test\_provider.py1-436](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/test/apps/webui/storage/test_provider.py#L1-L436)

## Installation Patterns

### Standard pip Installation

```
# Base installation (SQLite, ChromaDB)
pip install open-webui

# With PostgreSQL support
pip install open-webui[postgres]

# Complete installation
pip install open-webui[all]

# Multiple groups
pip install open-webui[postgres,all]
```
### Using uv (Modern Package Manager)

```
# Install with uv
uv pip install open-webui[postgres]

# Development environment with all features
uv pip install -r backend/requirements.txt
```
### Docker Implications

Docker images can be built with different dependency profiles:

-   **Standard Image**: Includes all dependencies from `requirements.txt`
-   **Minimal Image**: Could use `requirements-min.txt` for smaller footprint
-   **Custom Image**: Install base + specific optional groups

**Sources:** [backend/requirements-min.txt1-52](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements-min.txt#L1-L52) [.github/workflows/integration-test.disabled141-153](https://github.com/open-webui/open-webui/blob/a7271532/.github/workflows/integration-test.disabled#L141-L153)

## Conditional Dependency Usage

Several subsystems handle optional dependencies gracefully through conditional imports and runtime detection.

### Cloud Storage Provider Pattern

The storage provider system demonstrates how Open WebUI handles optional cloud dependencies:

```mermaid
flowchart TD
    GetProvider["get_storage_provider(provider: str)"]
    Local["LocalStorageProviderNo extra dependencies"]
    S3Check["boto3available?"]
    GCSCheck["google.cloud.storageavailable?"]
    AzureCheck["azure.storage.blobavailable?"]
    S3["S3StorageProvider"]
    Error1["RuntimeError"]
    GCS["GCSStorageProvider"]
    Error2["RuntimeError"]
    Azure["AzureStorageProvider"]
    Error3["RuntimeError"]

    GetProvider --> Local
    GetProvider --> S3Check
    GetProvider --> GCSCheck
    GetProvider --> AzureCheck
    S3Check --> S3
    S3Check --> Error1
    GCSCheck --> GCS
    GCSCheck --> Error2
    AzureCheck --> Azure
    AzureCheck --> Error3
```
The implementation relies on packages always being present in the base installation:

| Provider | Required Packages | Installation Status |
| --- | --- | --- |
| S3 | `boto3`, `botocore` | Always installed (base) |
| GCS | `google-cloud-storage`, `google-api-python-client` | Always installed (base) |
| Azure | `azure-storage-blob`, `azure-identity` | Always installed (base) |

**Import Pattern:**

```
# backend/open_webui/storage/provider.py:9-34
import boto3
from google.cloud import storage
from azure.identity import DefaultAzureCredential
from azure.storage.blob import BlobServiceClient
```
All cloud storage dependencies are unconditionally imported because they're included in the base `requirements.txt`.

**Sources:** [backend/open\_webui/storage/provider.py1-377](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/storage/provider.py#L1-L377) [backend/requirements.txt97-116](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements.txt#L97-L116)

### Vector Database Conditional Loading

```mermaid
flowchart TD
    Config["Vector DB ConfigurationVECTOR_DB environment variable"]
    ChromaAlways["ChromaDB(always available)"]
    WeaviateAlways["Weaviate(always available)"]
    MilvusOpt["Milvus(optional: all group)"]
    QdrantOpt["Qdrant(optional: all group)"]
    PineconeOpt["Pinecone(optional: all group)"]
    PGVectorOpt["pgvector(optional: postgres group)"]
    Required["In requirements.txt"]
    Optional["In all extras"]
    PostgresGroup["In postgres extras"]

    Config --> ChromaAlways
    Config --> WeaviateAlways
    Config --> MilvusOpt
    Config --> QdrantOpt
    Config --> PineconeOpt
    Config --> PGVectorOpt
    ChromaAlways --> Required
    WeaviateAlways --> Required
    MilvusOpt --> Optional
    QdrantOpt --> Optional
    PineconeOpt --> Optional
    PGVectorOpt --> PostgresGroup
```
**Base Installation Vector DBs** (always available):

-   `chromadb==1.1.0` - Default vector store
-   `weaviate-client==4.17.0` - Weaviate support
-   `opensearch-py==2.8.0` - OpenSearch support

**Optional Vector DBs** (require `[all]` group):

-   `qdrant-client==1.14.3` - Qdrant support
-   `pymilvus==2.6.4` - Milvus support
-   `pinecone==6.0.2` - Pinecone cloud support
-   `elasticsearch==9.1.0` - Elasticsearch support

**PostgreSQL Vector Extension** (requires `[postgres]` group):

-   `pgvector==0.4.1` - Vector similarity in PostgreSQL

**Sources:** [backend/requirements.txt51-123](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements.txt#L51-L123) [pyproject.toml132-158](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L132-L158)

## Testing Dependencies

### Test Framework Dependencies

The `all` optional group includes comprehensive testing infrastructure:

```mermaid
flowchart TD
    PyTest["pytest~=8.3.2Core testing framework"]
    PyTestDocker["pytest-docker~=3.2.5Docker fixtures"]
    Docker["docker~=7.1.0Container management"]
    Playwright["playwright==1.56.0Browser automation"]
    MotoS3["moto[s3]>=5.0.26AWS S3 emulator"]
    GCSEmulator["gcp-storage-emulator>=2024.8.3GCS emulator"]
    StorageTests["Storage Provider Tests"]
    VectorDBTests["Vector DB Tests"]
    IntegrationTests["Integration Tests"]

    PyTest --> StorageTests
    PyTestDocker --> IntegrationTests
    Docker --> IntegrationTests
    Playwright --> IntegrationTests
    MotoS3 --> StorageTests
    GCSEmulator --> StorageTests
```
### Storage Provider Test Pattern

Tests demonstrate how emulators replace real cloud services:

**S3 Testing with Moto:**

```
# Uses @mock_aws decorator
# backend/open_webui/test/apps/webui/storage/test_provider.py:100-189
@mock_aws
class TestS3StorageProvider:
    def __init__(self):
        self.Storage = provider.S3StorageProvider()
        self.s3_client = boto3.resource("s3", region_name="us-east-1")
```
**GCS Testing with Emulator:**

```
# Uses gcp_storage_emulator server
# backend/open_webui/test/apps/webui/storage/test_provider.py:202-292
@pytest.fixture(scope="class")
def setup(self):
    host, port = "localhost", 9023
    server = create_server(host, port, in_memory=True)
    server.start()
    os.environ["STORAGE_EMULATOR_HOST"] = f"http://{host}:{port}"
```
**Azure Testing with Mocks:**

```
# Uses unittest.mock.MagicMock
# backend/open_webui/test/apps/webui/storage/test_provider.py:294-436
mock_blob_service_client = MagicMock()
mock_container_client = MagicMock()
```
**Sources:** [backend/open\_webui/test/apps/webui/storage/test\_provider.py1-436](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/test/apps/webui/storage/test_provider.py#L1-L436) [pyproject.toml137-158](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L137-L158)

## Minimal Installation

For resource-constrained environments or air-gapped deployments, Open WebUI provides a minimal requirements file:

```mermaid
flowchart TD
    Core["Core FrameworkFastAPI, Uvicorn, Pydantic"]
    Auth["AuthenticationJWT, bcrypt, OAuth"]
    HTTP["HTTP Clientshttpx, aiohttp, requests"]
    DB["Basic DatabaseSQLAlchemy, Alembic, Peewee"]
    RT["Real-timeSocket.IO, Redis, pycrdt"]
    AI["Minimal AIOpenAI client, MCP, LangChain"]
    VectorMin["Basic VectorChromaDB only"]
    MinimalDeployment["Minimal Deployment"]
    FullDeployment["Standard Deployment"]
    RequirementsTxt["requirements.txt+Document processing+Multiple vector DBs+Cloud storage+Web scraping"]

    MinimalDeployment --> Core
    MinimalDeployment --> Auth
    MinimalDeployment --> HTTP
    MinimalDeployment --> DB
    MinimalDeployment --> RT
    MinimalDeployment --> AI
    MinimalDeployment --> VectorMin
    FullDeployment --> RequirementsTxt
```
**Minimal Installation Excludes:**

-   Document processing libraries (pypdf, python-pptx, docx2txt, etc.)
-   Computer vision (opencv, pillow)
-   Audio processing (faster-whisper, pydub)
-   OCR and advanced extraction (rapidocr, unstructured)
-   Machine learning models (sentence-transformers, transformers)
-   Alternative vector databases (weaviate, milvus, qdrant)
-   Cloud-specific SDKs (detailed Azure/GCS packages)
-   Web automation (playwright, selenium)

**Minimal Installation Includes:**

-   Basic RAG with ChromaDB
-   OpenAI API compatibility
-   SQLite or PostgreSQL (with manual install)
-   Redis for real-time features
-   Core LangChain functionality

**Sources:** [backend/requirements-min.txt1-52](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements-min.txt#L1-L52)

## Dependency Version Management

### Version Pinning Strategy

Open WebUI uses strict version pinning for most dependencies to ensure reproducibility:

| Category | Pinning Strategy | Example |
| --- | --- | --- |
| Core Framework | Exact versions | `fastapi==0.123.0` |
| AI Libraries | Exact versions | `openai`, `anthropic` (unpinned) |
| Vector DBs | Exact versions | `chromadb==1.1.0` |
| Cloud SDKs | Exact versions | `boto3==1.41.5` |
| Testing | Flexible with `~=` | `pytest~=8.3.2` |
| Emulators | Minimum with `>=` | `moto[s3]>=5.0.26` |

### Lock File

The `uv.lock` file provides reproducible builds across all platforms with:

-   Resolved dependency tree
-   Platform-specific wheels
-   Content hashes for integrity
-   Resolution markers for different Python versions and platforms

**Sources:** [pyproject.toml8-117](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L8-L117) [uv.lock1-17](https://github.com/open-webui/open-webui/blob/a7271532/uv.lock#L1-L17)

## Common Installation Scenarios

### Production Deployment with PostgreSQL

```
pip install open-webui[postgres]
export DATABASE_URL="postgresql://user:pass@host:5432/db"
export VECTOR_DB="pgvector"  # Use PostgreSQL for vectors too
```
### Development Environment

```
pip install open-webui[all]
# Or directly from requirements.txt
pip install -r backend/requirements.txt
```
### Air-Gapped/Minimal Deployment

```
pip install -r backend/requirements-min.txt
# Manually copy ChromaDB data directory
# SQLite database is portable
```
### Docker with Custom Dependencies

```
FROM python:3.11
COPY backend/requirements.txt .
# Install base + specific extras
RUN pip install -r requirements.txt
# Or: RUN pip install open-webui[postgres]
```
**Sources:** [.github/workflows/integration-test.disabled141-153](https://github.com/open-webui/open-webui/blob/a7271532/.github/workflows/integration-test.disabled#L141-L153) [pyproject.toml160-193](https://github.com/open-webui/open-webui/blob/a7271532/pyproject.toml#L160-L193)

## Troubleshooting Optional Dependencies

### Missing Dependency Errors

**Symptom:** `ImportError` or `ModuleNotFoundError` at runtime

**Common Causes:**

-   Using a feature that requires optional dependencies
-   Attempting to configure Qdrant/Milvus/Pinecone without `[all]` group
-   Using PostgreSQL without `[postgres]` group

**Solution:**

```
# Install the missing group
pip install open-webui[postgres,all]

# Or install specific package
pip install qdrant-client==1.14.3
```
### Version Conflicts

**Symptom:** Dependency resolver errors during installation

**Common Causes:**

-   Conflicting package versions from other projects
-   Platform-specific issues (especially ARM/Raspberry Pi)

**Solution:**

```
# Use virtual environment
python -m venv venv
source venv/bin/activate
pip install open-webui[postgres]

# Or use uv for better resolution
uv pip install open-webui[postgres]
```
### Platform-Specific Issues

Some dependencies have platform-specific constraints:

-   **Raspberry Pi:** `pyarrow==20.0.0` pinned for compatibility ([requirements.txt58](https://github.com/open-webui/open-webui/blob/a7271532/requirements.txt#L58-L58))
-   **FIPS Systems:** `av==14.0.1` pinned to avoid FIPS self-test failure ([requirements.txt125](https://github.com/open-webui/open-webui/blob/a7271532/requirements.txt#L125-L125))
-   **ARM Systems:** Some ML dependencies may require system libraries

**Sources:** [backend/requirements.txt58-125](https://github.com/open-webui/open-webui/blob/a7271532/backend/requirements.txt#L58-L125)
