# Response Message Component

Relevant source files

-   [src/lib/components/chat/Messages.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages.svelte)
-   [src/lib/components/chat/Messages/ResponseMessage.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte)
-   [src/lib/components/chat/Messages/UserMessage.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/UserMessage.svelte)
-   [src/lib/components/chat/Settings/Interface.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Settings/Interface.svelte)
-   [src/lib/components/chat/SettingsModal.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/SettingsModal.svelte)
-   [src/lib/components/common/Modal.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/common/Modal.svelte)
-   [src/lib/utils/index.ts](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/utils/index.ts)
-   [src/routes/(app)/+layout.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/routes/(app)/+layout.svelte)/+layout.svelte)
-   [src/routes/(app)/+page.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/routes/(app)/+page.svelte)/+page.svelte)
-   [src/routes/(app)/c/\[id\]/+page.svelte](src/routes/(app)/c/%5Bid%5D/+page.svelte)

## Purpose and Scope

The Response Message Component (`ResponseMessage.svelte`) is responsible for rendering individual assistant/model messages within the chat interface. It manages the display of message content, handles user interactions (edit, copy, rate, TTS), and integrates with various features including citations, code execution, web search results, and follow-ups.

For information about the overall message rendering pipeline, see [Content Rendering Pipeline](/open-webui/open-webui/5.2-content-rendering-pipeline). For user-initiated messages, see the UserMessage component in the Messages system. For handling multiple model responses, see [Multi-Model Response Display](/open-webui/open-webui/5.5-multi-model-response-display).

---

## Component Architecture

### Component Role and Responsibilities

`ResponseMessage.svelte` serves as the orchestrator for rendering assistant responses. It is instantiated by `Message.svelte` for each assistant message in the conversation tree and manages:

-   Message content display through `ContentRenderer`
-   Action buttons (edit, copy, rate, TTS, regenerate)
-   Status updates and streaming indicators
-   Citations and code execution results
-   File attachments and embedded iframes
-   Sibling message navigation
-   Feedback/rating collection

**Component Hierarchy:**

```mermaid
flowchart TD
    Messages["Messages.svelte(Message List Manager)"]
    Message["Message.svelte(Message Router)"]
    ResponseMessage["ResponseMessage.svelte(Assistant Message Display)"]
    ContentRenderer["ContentRenderer.svelte(Content Parser)"]
    ProfileImage["ProfileImage.svelte"]
    Name["Name.svelte"]
    StatusHistory["StatusHistory.svelte"]
    Citations["Citations.svelte"]
    CodeExecutions["CodeExecutions.svelte"]
    RateComment["RateComment.svelte"]
    FollowUps["FollowUps.svelte"]
    WebSearchResults["WebSearchResults.svelte"]
    RegenerateMenu["RegenerateMenu.svelte"]

    Messages --> Message
    Message --> ResponseMessage
    ResponseMessage --> ProfileImage
    ResponseMessage --> Name
    ResponseMessage --> StatusHistory
    ResponseMessage --> ContentRenderer
    ResponseMessage --> Citations
    ResponseMessage --> CodeExecutions
    ResponseMessage --> RateComment
    ResponseMessage --> FollowUps
    ResponseMessage --> WebSearchResults
    ResponseMessage --> RegenerateMenu
```
Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte1-65](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L1-L65) [src/lib/components/chat/Messages.svelte1-50](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages.svelte#L1-L50)

---

## Props and Data Interface

### Message Data Structure

The component receives a `MessageType` interface that defines the message structure:

```mermaid
flowchart TD
    MessageType["MessageType Interface"]
    Core["Core Fields:id, model, content,role, timestamp, done"]
    Files["files[]:type, url"]
    Status["status/statusHistory:action, description,done, urls, query"]
    CodeExec["code_executions[]:uuid, name, code,language, result"]
    Meta["info:tokens, duration,usage statistics"]
    Feedback["annotation:type, rating"]

    MessageType --> Core
    MessageType --> Files
    MessageType --> Status
    MessageType --> CodeExec
    MessageType --> Meta
    MessageType --> Feedback
```
**Key Props:**

| Prop | Type | Purpose |
| --- | --- | --- |
| `chatId` | string | Current chat identifier |
| `history` | object | Complete message tree structure |
| `messageId` | string | ID of this specific message |
| `siblings` | array | IDs of sibling messages at same tree level |
| `selectedModels` | array | Currently selected model IDs |
| `isLastMessage` | boolean | Whether this is the most recent message |
| `readOnly` | boolean | Disables editing capabilities |
| `editCodeBlock` | boolean | Enables code block editing |

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte66-152](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L66-L152)

---

## Action Handler System

### Action Handler Flow

```mermaid
flowchart TD
    User["User Action"]
    Copy["copyToClipboard()lines 177-188"]
    Speak["speak()lines 202-326"]
    Edit["editMessageHandler()lines 355-364"]
    EditConfirm["editMessageConfirmHandler()lines 366-374"]
    SaveCopy["saveAsCopyHandler()lines 376-385"]
    GenImage["generateImage()lines 393-413"]
    Feedback["feedbackHandler()lines 417-533"]
    Delete["deleteMessageHandler()lines 535-537"]
    ToastSuccess["toast.success()"]
    TTSEngine["TTS Engine:browser, browser-kokoro,or synthesizeOpenAISpeech"]
    ParentEdit["editMessage(messageId, content)"]
    CreateFeedback["createNewFeedback() orupdateFeedbackById()"]
    ImageGenAPI["imageGenerations(token, content)"]
    ParentDelete["deleteMessage(messageId)"]

    User --> Copy
    User --> Speak
    User --> Edit
    User --> GenImage
    User --> Feedback
    User --> Delete
    Edit --> EditConfirm
    Edit --> SaveCopy
    Copy --> ToastSuccess
    Speak --> TTSEngine
    EditConfirm --> ParentEdit
    Feedback --> CreateFeedback
    GenImage --> ImageGenAPI
    Delete --> ParentDelete
```
### Copy to Clipboard Handler

The copy function removes `<details>` tags and optionally adds a watermark before copying:

-   **Function:** `copyToClipboard` [src/lib/components/chat/Messages/ResponseMessage.svelte177-188](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L177-L188)
-   **Process:**
    1.  Removes all `<details>` blocks via `removeAllDetails()`
    2.  Appends `$config?.ui?.response_watermark` if configured
    3.  Calls `_copyToClipboard()` with formatted content
    4.  Supports formatted copying via `$settings?.copyFormatted`

### Text-to-Speech Handler

The TTS system supports multiple engines and streaming audio playback:

**TTS Features:**

-   **Content splitting:** Messages split by punctuation or newlines for progressive playback
-   **Browser Kokoro:** Local TTS using WebAssembly worker [src/lib/components/chat/Messages/ResponseMessage.svelte270-299](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L270-L299)
-   **OpenAI TTS:** Server-side synthesis via API [src/lib/components/chat/Messages/ResponseMessage.svelte301-323](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L301-L323)
-   **Audio queue:** Progressive streaming with playback rate control [src/lib/components/chat/Messages/ResponseMessage.svelte247-252](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L247-L252)
-   **Conversation mode:** Automatically triggers voice input after TTS completes [src/lib/components/chat/Messages/ResponseMessage.svelte234-236](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L234-L236)

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte202-326](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L202-L326)

### Edit Message System

The edit system preserves `<details>` blocks during editing:

**Edit Flow:**

```mermaid
flowchart TD
    EditButton["Edit Button Click"]
    PreProcess["preprocessForEditing()lines 330-344:Replace details with placeholders"]
    ShowTextarea["Display textareawith processed contentlines 708-768"]
    UserEdit["User modifies content"]
    SaveOptions["Save Option?"]
    SaveCopy["Save As CopysaveAsCopyHandler()lines 376-385"]
    SaveEdit["Confirm EditeditMessageConfirmHandler()lines 366-374"]
    PostProcess["postprocessAfterEditing()lines 346-353:Restore details blocks"]
    ParentEditMsg["editMessage(messageId, content, false/true)"]

    EditButton --> PreProcess
    PreProcess --> ShowTextarea
    ShowTextarea --> UserEdit
    UserEdit --> SaveOptions
    SaveOptions --> SaveCopy
    SaveOptions --> SaveEdit
    SaveCopy --> PostProcess
    SaveEdit --> PostProcess
    PostProcess --> ParentEditMsg
```
**Details Block Handling:**

-   `preprocessForEditing()` replaces `<details>...</details>` with placeholders like `<details id="__DETAIL_0__"/>`
-   Blocks stored in `preprocessedDetailsCache` array
-   `postprocessAfterEditing()` restores original blocks by ID
-   Enables editing without corrupting structured content

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte330-391](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L330-L391)

### Feedback and Rating System

The feedback handler creates or updates evaluation records:

**Feedback Data Flow:**

```mermaid
flowchart TD
    RateButton["Rating Button(thumbs up/down)"]
    BuildFeedback["feedbackHandler()Construct feedbackItem:- type: 'rating'- data: annotation- meta: arena, model_id- snapshot: chat"]
    CheckExisting["message.feedbackIdexists?"]
    CreateNew["createNewFeedback()POST to backend"]
    UpdateExist["updateFeedbackById()PUT to backend"]
    SaveLocal["saveMessage()Update local history"]
    ShowComment["showRateComment = trueDisplay comment UI"]
    GenTags["generateTags()Auto-generate tagsif none exist"]
    UpdateTags["Update feedbackwith generated tags"]

    RateButton --> BuildFeedback
    BuildFeedback --> CheckExisting
    CheckExisting --> CreateNew
    CheckExisting --> UpdateExist
    CreateNew --> SaveLocal
    UpdateExist --> SaveLocal
    SaveLocal --> ShowComment
    ShowComment --> GenTags
    GenTags --> UpdateTags
```
**Feedback Item Structure:**

```
{
  type: 'rating',
  data: {
    rating: number,
    model_id: string,
    sibling_model_ids?: string[],  // For arena comparisons
    tags?: string[]
  },
  meta: {
    arena: boolean,
    model_id: string,
    message_id: string,
    message_index: number,
    chat_id: string,
    base_models: { [modelId]: base_model_id }
  },
  snapshot: {
    chat: ChatObject
  }
}
```
Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte417-533](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L417-L533)

---

## Content Display System

### Rendering Flow

```mermaid
flowchart TD
    Check["Message State?"]
    Skeleton["Skeleton.svelteLoading indicatorlines 776-777"]
    Content["Content Displaylines 778-819"]
    StatusHist["StatusHistory.sveltelines 664-666"]
    Files["File/Image Displaylines 668-690"]
    Embeds["FullHeightIframelines 692-706"]
    EditMode["Edit Textarealines 708-768"]
    ContentRender["ContentRenderer.sveltelines 781-819"]
    Error["Error.sveltelines 822-824"]
    Citations["Citations.sveltelines 826-834"]
    CodeExec["CodeExecutions.sveltelines 836-838"]

    Check --> Skeleton
    Check --> Content
    Check --> Error
    Content --> StatusHist
    Content --> Files
    Content --> Embeds
    Content --> EditMode
    Content --> ContentRender
    ContentRender --> Citations
    ContentRender --> CodeExec
```
### ContentRenderer Integration

The component delegates content parsing to `ContentRenderer.svelte`:

**ContentRenderer Props:**

| Prop | Value | Purpose |
| --- | --- | --- |
| `id` | `${chatId}-${message.id}` | Unique identifier |
| `messageId` | message.id | Message reference |
| `history` | history | Full message tree |
| `selectedModels` | selectedModels | Model context |
| `content` | message.content | Raw message text |
| `sources` | message.sources | Citation sources |
| `floatingButtons` | Conditional | Show text selection actions |
| `save` | !readOnly | Enable save functionality |
| `preview` | !readOnly | Enable preview mode |
| `editCodeBlock` | editCodeBlock | Code block editing |
| `done` | message.done | Streaming complete flag |
| `model` | model | Model metadata |

**Event Handlers:**

-   `onSourceClick`: Opens citation modal via `citationsElement?.showSourceModal(id)` [src/lib/components/chat/Messages/ResponseMessage.svelte802-808](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L802-L808)
-   `onAddMessages`: Adds messages to tree via `addMessages({ modelId, parentId, messages })` [src/lib/components/chat/Messages/ResponseMessage.svelte809-811](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L809-L811)
-   `onSave`: Updates message content and persists via `updateChat()` [src/lib/components/chat/Messages/ResponseMessage.svelte812-818](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L812-L818)

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte771-819](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L771-L819)

---

## Action Button Layout

### Button Container System

```mermaid
flowchart TD
    Container["buttonsContainerElementdiv.buttonslines 844-847"]
    NavButtons["Sibling NavigationPrevious/NextIndex Editorlines 848-943"]
    EditBtn["Edit Buttonlines 947-976"]
    CopyBtn["Copy Buttonlines 979-1005"]
    TTSBtn["Read Aloudlines 1007-1092"]
    ImageBtn["Generate Imagelines 1095-1160"]
    InfoBtn["Usage Infolines 1162-1193"]
    ActionBtns["Action ButtonsCustom actionslines 1195-1233"]
    RateBtn["Rating Buttonslines 1235-1321"]

    Container --> NavButtons
    Container --> EditBtn
    Container --> CopyBtn
    Container --> TTSBtn
    Container --> ImageBtn
    Container --> InfoBtn
    Container --> ActionBtns
    Container --> RateBtn
```
### Horizontal Scroll Handler

The button container supports horizontal scrolling for overflow:

-   **Element:** `buttonsContainerElement` [src/lib/components/chat/Messages/ResponseMessage.svelte157](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L157-L157)
-   **Handler:** `buttonsWheelHandler` [src/lib/components/chat/Messages/ResponseMessage.svelte545-559](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L545-L559)
-   **Logic:** Converts vertical wheel events to horizontal scroll when content overflows
-   **Lifecycle:** Added in `onMount()`, removed in `onDestroy()`

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte545-610](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L545-L610)

---

## Sibling Message Navigation

### Navigation System

```mermaid
flowchart TD
    Siblings["siblings.length > 1?"]
    NavUI["Display Navigation UIlines 848-943"]
    PrevBtn["Previous ButtonshowPreviousMessage()"]
    NextBtn["Next ButtonshowNextMessage()"]
    Index["Message IndexX/Y display"]
    EditMode["messageIndexEdit?"]
    StaticIndex["Static DisplayDouble-click to edit"]
    InputIndex["Number InputgotoMessage() on change"]

    Siblings --> NavUI
    NavUI --> PrevBtn
    NavUI --> NextBtn
    NavUI --> Index
    Index --> EditMode
    EditMode --> StaticIndex
    EditMode --> InputIndex
    StaticIndex --> InputIndex
    InputIndex --> StaticIndex
```
**Navigation Functions:**

-   `showPreviousMessage(message)`: Navigates to previous sibling \[passed as prop\]
-   `showNextMessage(message)`: Navigates to next sibling \[passed as prop\]
-   `gotoMessage(message, idx)`: Jumps to specific sibling index \[passed as prop\]

**Index Editor:**

-   Double-click index number to activate edit mode
-   Type number and press Enter or blur to navigate
-   Provides direct jump capability for messages with many siblings

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte848-943](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L848-L943)

---

## Status Updates and Streaming

### Status Display Mechanism

The component shows real-time status updates during message generation:

```mermaid
flowchart TD
    StatusCheck["model.info.meta.capabilities.status_updates?"]
    StatusHistory["StatusHistory.sveltelines 664-666"]
    StatusProp["message.statusHistoryor [message.status]"]
    WebSearch["Web Search ResultsWebSearchResults.svelte"]
    ToolExec["Tool Execution"]
    RAG["RAG Queries"]
    ImageGen["Image Generation"]

    StatusCheck --> StatusHistory
    StatusHistory --> StatusProp
    StatusProp --> WebSearch
    StatusProp --> ToolExec
    StatusProp --> RAG
    StatusProp --> ImageGen
```
**Status History Structure:**

```
statusHistory?: {
  done: boolean;
  action: string;
  description: string;
  urls?: string[];
  query?: string;
}[]
```
**Display Logic:**

-   Shows `Skeleton.svelte` when `content === ''` and no status updates visible [src/lib/components/chat/Messages/ResponseMessage.svelte776-777](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L776-L777)
-   Hidden status updates (`.hidden === true`) don't prevent skeleton display
-   Capability can be disabled per-model via `model.info.meta.capabilities.status_updates`

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte664-690](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L664-L690) [src/lib/components/chat/Messages/ResponseMessage/StatusHistory.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage/StatusHistory.svelte)

---

## Additional Features Integration

### Follow-Ups System

Follow-up suggestions display after message completion:

-   **Component:** `FollowUps.svelte` [src/lib/components/chat/Messages/ResponseMessage.svelte1323-1340](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L1323-L1340)
-   **Condition:** `message.done && message.followUps?.length > 0`
-   **Props:**
    -   `chatId`: Current chat ID
    -   `followUps`: Array of follow-up prompts
    -   `submitMessage`: Callback to send follow-up as new message

### Regenerate Menu

Provides regeneration options when message is complete:

-   **Component:** `RegenerateMenu.svelte` [src/lib/components/chat/Messages/ResponseMessage.svelte1343-1360](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L1343-L1360)
-   **Display Conditions:**
    -   `isLastMessage === true`
    -   `!readOnly`
    -   User has regenerate permissions
    -   `$settings?.regenerateMenu !== false`
-   **Actions:**
    -   `regenerateResponse(message, mergeMode)`
    -   `continueResponse(message)`

### Content Copy Handler

Custom copy behavior for styled content:

-   **Handler:** `contentCopyHandler` [src/lib/components/chat/Messages/ResponseMessage.svelte561-587](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L561-L587)
-   **Function:** Intercepts copy events to clean HTML styling
-   **Process:**
    1.  Captures selected content from DOM
    2.  Removes background/color/font styles
    3.  Formats tables with consistent styling
    4.  Sets clipboard data with both HTML and plain text

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte1323-1360](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L1323-L1360) [src/lib/components/chat/Messages/ResponseMessage.svelte561-610](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L561-L610)

---

## State Management

### Local State Variables

| Variable | Type | Purpose |
| --- | --- | --- |
| `message` | MessageType | Local copy of message data, reactively synced |
| `model` | object | Model metadata from `$models` store |
| `edit` | boolean | Edit mode toggle |
| `editedContent` | string | Content during editing |
| `speaking` | boolean | TTS playback active |
| `loadingSpeech` | boolean | TTS generation in progress |
| `generatingImage` | boolean | Image generation in progress |
| `showRateComment` | boolean | Rating comment UI visible |
| `feedbackLoading` | boolean | Feedback submission in progress |
| `messageIndexEdit` | boolean | Message index input active |

### Reactive Sync Pattern

```mermaid
flowchart TD
    HistoryStore["history.messages[messageId](Parent-provided)"]
    LocalCopy["message(Local state)"]
    ReactiveBlock["$: if (history.messages)Deep comparisonlines 123-127"]
    DeepCopy["JSON.parse(JSON.stringify())"]

    HistoryStore --> ReactiveBlock
    ReactiveBlock --> DeepCopy
    DeepCopy --> LocalCopy
```
**Sync Logic:**

-   Compares stringified JSON to detect changes [src/lib/components/chat/Messages/ResponseMessage.svelte123-127](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L123-L127)
-   Creates deep copy to prevent reference mutations
-   Ensures UI reflects latest message state from parent

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte122-152](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L122-L152)

---

## Integration Points

### Parent Communication

**Props from Messages.svelte:**

```mermaid
flowchart TD
    Messages["Messages.svelte"]
    Message["Message.svelte"]
    Response["ResponseMessage.svelte"]

    Messages --> Message
    Message --> Response
    Response --> Messages
    Response --> Messages
    Response --> Messages
    Response --> Messages
    Response --> Messages
    Response --> Messages
    Response --> Messages
    Response --> Messages
```
**Callback Functions:**

-   `editMessage(messageId, content, submit)`: Modifies message content \[prop\]
-   `deleteMessage(messageId)`: Removes message from tree \[prop\]
-   `rateMessage(messageId, rating)`: Updates rating \[prop\]
-   `saveMessage(messageId, message)`: Persists message changes \[prop\]
-   `updateChat()`: Syncs changes to backend \[prop\]
-   `submitMessage()`: Sends new message \[prop\]
-   `regenerateResponse(message, mergeMode)`: Regenerates response \[prop\]
-   `continueResponse(message)`: Continues partial response \[prop\]
-   `addMessages(params)`: Adds messages to tree \[prop\]

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte131-148](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L131-L148) [src/lib/components/chat/Messages.svelte255-389](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages.svelte#L255-L389)

---

## Summary

`ResponseMessage.svelte` is a feature-rich component that orchestrates assistant message display with extensive action handling capabilities. It integrates with multiple subsystems (TTS, citations, code execution, feedback) while maintaining clean separation of concerns through component composition. The reactive state management ensures UI consistency, and the edit system preserves complex content structures during modification.

Key architectural patterns:

-   **Deep copy sync** for safe local state management
-   **Conditional rendering** based on message state and capabilities
-   **Event delegation** to parent for tree modifications
-   **Progressive enhancement** through feature flags and permissions
-   **Preprocessing/postprocessing** for content preservation during edits

Sources: [src/lib/components/chat/Messages/ResponseMessage.svelte1-1791](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Messages/ResponseMessage.svelte#L1-L1791)
