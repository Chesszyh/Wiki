# Environment Configuration

Relevant source files

-   [LICENSE](https://github.com/open-webui/open-webui/blob/a7271532/LICENSE)
-   [README.md](https://github.com/open-webui/open-webui/blob/a7271532/README.md)
-   [TROUBLESHOOTING.md](https://github.com/open-webui/open-webui/blob/a7271532/TROUBLESHOOTING.md)
-   [backend/open\_webui/env.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py)
-   [backend/open\_webui/routers/audio.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/audio.py)
-   [backend/open\_webui/routers/auths.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/auths.py)
-   [backend/open\_webui/routers/ollama.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/ollama.py)
-   [backend/open\_webui/routers/openai.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/openai.py)
-   [backend/open\_webui/utils/auth.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/auth.py)
-   [backend/open\_webui/utils/embeddings.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/embeddings.py)
-   [backend/open\_webui/utils/misc.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/misc.py)
-   [backend/open\_webui/utils/oauth.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/oauth.py)
-   [backend/open\_webui/utils/response.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/response.py)
-   [docs/apache.md](https://github.com/open-webui/open-webui/blob/a7271532/docs/apache.md)
-   [src/lib/components/chat/Settings/About.svelte](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/components/chat/Settings/About.svelte)
-   [src/lib/constants.ts](https://github.com/open-webui/open-webui/blob/a7271532/src/lib/constants.ts)

## Purpose and Scope

This document covers the environment variable configuration system in Open WebUI. Environment variables control application behavior, external service connections, authentication mechanisms, storage backends, and feature flags. This page focuses on the technical implementation of how environment variables are loaded, validated, and used throughout the application.

For specific deployment configurations, see [Docker Deployment Options](/open-webui/open-webui/3.2-docker-deployment-options). For persistent configuration stored in the database, see [Persistent Configuration System](/open-webui/open-webui/11.2-persistent-configuration-system). For authentication-specific setup, see [Authentication Methods](/open-webui/open-webui/10.1-authentication-methods).

## Configuration Loading Architecture

Open WebUI's configuration system is initialized in `backend/open_webui/env.py`, which loads environment variables from `.env` files and system environment, validates them, and exposes them as Python module constants.

### Configuration Loading Flow

```mermaid
flowchart TD
    ENV_FILE[".env filein BASE_DIR"]
    SYS_ENV["System EnvironmentVariables"]
    DOTENV["dotenv.load_dotenv()env.py:35-39"]
    PARSE["Parse and Validateenv.py:41-889"]
    PATH_VARS["Path VariablesDATA_DIR, STATIC_DIRFRONTEND_BUILD_DIR"]
    DB_VARS["Database VariablesDATABASE_URLDATABASE_POOL_SIZE"]
    REDIS_VARS["Redis VariablesREDIS_URLREDIS_CLUSTER"]
    AUTH_VARS["Authentication VariablesWEBUI_SECRET_KEYOAUTH_*"]
    API_VARS["API ConfigurationOLLAMA_BASE_URLOPENAI_API_KEY"]
    FEATURE_VARS["Feature FlagsENABLE_*"]
    APP_STATE["Application Stateapp.state.config"]
    ROUTES["API RoutesUse Configuration"]
    MIDDLEWARE["MiddlewareApply Policies"]
    SERVICES["External ServicesConnection Setup"]

    ENV --> FILE_DOTENV
    SYS --> ENV_DOTENV
    DOTENV --> PARSE
    PARSE --> PATH_VARS
    PARSE --> DB_VARS
    PARSE --> REDIS_VARS
    PARSE --> AUTH_VARS
    PARSE --> API_VARS
    PARSE --> FEATURE_VARS
    PATH --> VARS_APP_STATE
    DB --> VARS_APP_STATE
    REDIS --> VARS_APP_STATE
    AUTH --> VARS_APP_STATE
    API --> VARS_APP_STATE
    FEATURE --> VARS_APP_STATE
    APP --> STATE_ROUTES
    APP --> STATE_MIDDLEWARE
    APP --> STATE_SERVICES
```
**Sources:** [backend/open\_webui/env.py1-889](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L1-L889)

### Path Resolution and Directory Structure

The configuration system first establishes the directory hierarchy:

```mermaid
flowchart TD
    ENV_PY["env.pyfile"]
    RESOLVE["Path(file).resolve()env.py:23"]
    OPEN_WEBUI_DIR["OPEN_WEBUI_DIRbackend/open_webui/env.py:26"]
    BACKEND_DIR["BACKEND_DIRbackend/env.py:29"]
    BASE_DIR["BASE_DIRopen-webui-dev/env.py:32"]
    DATA_DIR["DATA_DIRbackend/data/env.py:210"]
    STATIC_DIR["STATIC_DIRopen_webui/static/env.py:234"]
    FRONTEND_BUILD_DIR["FRONTEND_BUILD_DIRbuild/env.py:238"]
    DB_FILE["webui.db"]
    UPLOAD_DIR["uploads/"]
    CACHE_DIR["cache/"]

    ENV --> PY_RESOLVE
    RESOLVE --> OPEN_WEBUI_DIR
    OPEN --> WEBUI_DIR_BACKEND_DIR
    BACKEND --> DIR_BASE_DIR
    BASE --> DIR_DATA_DIR
    BASE --> DIR_STATIC_DIR
    BASE --> DIR_FRONTEND_BUILD_DIR
    DATA --> DIR_DB_FILE
    DATA --> DIR_UPLOAD_DIR
    DATA --> DIR_CACHE_DIR
```
**Sources:** [backend/open\_webui/env.py23-244](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L23-L244)

## Core Configuration Categories

### LLM Provider Connection Configuration

Environment variables for connecting to Ollama and OpenAI-compatible APIs:

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `OLLAMA_BASE_URL` | string | (runtime config) | Base URL for Ollama API server |
| `OLLAMA_BASE_URLS` | list | (runtime config) | Multiple Ollama endpoints for load balancing |
| `OLLAMA_API_CONFIGS` | dict | (runtime config) | Per-endpoint configuration (keys, model filtering) |
| `OPENAI_API_BASE_URLS` | list | (runtime config) | OpenAI-compatible API endpoints |
| `OPENAI_API_KEYS` | list | (runtime config) | API keys corresponding to base URLs |
| `OPENAI_API_CONFIGS` | dict | (runtime config) | Authentication types, headers, model configurations |

These are primarily stored in the persistent configuration system (see [Persistent Configuration System](/open-webui/open-webui/11.2-persistent-configuration-system)) but can be initialized via environment variables.

```mermaid
flowchart TD
    CLIENT["Chat Request"]
    ROUTER["FastAPI Router/ollama or /openai"]
    CONFIG_CHECK["Checkapp.state.config"]
    OLLAMA_URLS["OLLAMA_BASE_URLSrouters/ollama.py:331"]
    OPENAI_URLS["OPENAI_API_BASE_URLSrouters/openai.py:361"]
    LOAD_BALANCE["Load BalanceSelect URL by index"]
    API_CONFIG["Get API Configby index or URL"]
    AUTH_TYPE["auth_typerouters/openai.py:145"]
    BEARER["Add Authorization:Bearer token"]
    NO_AUTH["No authentication"]
    SESSION["Use session cookies"]
    OAUTH["OAuth token"]
    AZURE["Azure Entra ID"]
    FORWARD["Forward toExternal API"]

    CLIENT --> ROUTER
    ROUTER --> CONFIG_CHECK
    CONFIG --> CHECK_OLLAMA_URLS
    CONFIG --> CHECK_OPENAI_URLS
    OLLAMA --> URLS_LOAD_BALANCE
    OPENAI --> URLS_LOAD_BALANCE
    LOAD --> BALANCE_API_CONFIG
    API --> CONFIG_AUTH_TYPE
    AUTH --> TYPE_BEARER
    AUTH --> TYPE_NO_AUTH
    AUTH --> TYPE_SESSION
    AUTH --> TYPE_OAUTH
    AUTH --> TYPE_AZURE
    BEARER --> FORWARD
    NO --> AUTH_FORWARD
    SESSION --> FORWARD
    OAUTH --> FORWARD
    AZURE --> FORWARD
```
**Sources:** [backend/open\_webui/routers/ollama.py267-303](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/ollama.py#L267-L303) [backend/open\_webui/routers/openai.py207-265](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/openai.py#L207-L265) [backend/open\_webui/routers/openai.py118-180](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/routers/openai.py#L118-L180)

### Database Configuration

```mermaid
flowchart TD
    ENV_VARS["Environment Variables"]
    DATABASE_URL["DATABASE_URLenv.py:257"]
    DATABASE_TYPE["DATABASE_TYPEenv.py:259"]
    DB_CREDS["DATABASE_USERDATABASE_PASSWORDenv.py:260-261"]
    DB_CONN["DATABASE_HOSTDATABASE_PORTDATABASE_NAMEenv.py:269-274"]
    BUILD_URL["Build DATABASE_URL?env.py:277-278"]
    CONSTRUCT["Construct URL:type://user:pass@host:port/db"]
    NORMALIZE["Normalize:postgres:// â†’ postgresql://env.py:284-285"]
    POOL_CONFIG["Connection Pool Config"]
    POOL_SIZE["DATABASE_POOL_SIZEenv.py:289"]
    OVERFLOW["DATABASE_POOL_MAX_OVERFLOWenv.py:297"]
    TIMEOUT["DATABASE_POOL_TIMEOUTenv.py:307"]
    RECYCLE["DATABASE_POOL_RECYCLEenv.py:317"]
    SCHEMA["DATABASE_SCHEMAenv.py:287"]
    WAL["DATABASE_ENABLE_SQLITE_WALenv.py:327-329"]

    ENV --> VARS_DATABASE_URL
    ENV --> VARS_DATABASE_TYPE
    ENV --> VARS_DB_CREDS
    ENV --> VARS_DB_CONN
    DATABASE --> TYPE_BUILD_URL
    DB --> CREDS_BUILD_URL
    DB --> CONN_BUILD_URL
    BUILD --> URL_CONSTRUCT
    BUILD --> URL_DATABASE_URL
    CONSTRUCT --> NORMALIZE
    DATABASE --> URL_NORMALIZE
    NORMALIZE --> POOL_CONFIG
    POOL --> CONFIG_POOL_SIZE
    POOL --> CONFIG_OVERFLOW
    POOL --> CONFIG_TIMEOUT
    POOL --> CONFIG_RECYCLE
    NORMALIZE --> SCHEMA
    NORMALIZE --> WAL
```
**Database Environment Variables:**

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `DATABASE_URL` | string | `sqlite:///DATA_DIR/webui.db` | Full database connection string |
| `DATABASE_TYPE` | string | \- | Database type (postgresql, mysql, sqlite, sqlite+sqlcipher) |
| `DATABASE_USER` | string | \- | Database username |
| `DATABASE_PASSWORD` | string | \- | Database password |
| `DATABASE_HOST` | string | \- | Database host |
| `DATABASE_PORT` | string | \- | Database port |
| `DATABASE_NAME` | string | \- | Database name |
| `DATABASE_SCHEMA` | string | None | PostgreSQL schema name |
| `DATABASE_POOL_SIZE` | int | None | SQLAlchemy connection pool size |
| `DATABASE_POOL_MAX_OVERFLOW` | int | 0 | Max overflow connections beyond pool size |
| `DATABASE_POOL_TIMEOUT` | int | 30 | Timeout in seconds for getting connection from pool |
| `DATABASE_POOL_RECYCLE` | int | 3600 | Recycle connections after N seconds |
| `DATABASE_ENABLE_SQLITE_WAL` | bool | False | Enable Write-Ahead Logging for SQLite |
| `DATABASE_USER_ACTIVE_STATUS_UPDATE_INTERVAL` | float | None | Interval for updating user active status |

**Sources:** [backend/open\_webui/env.py257-340](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L257-L340)

### Redis Configuration

Redis is used for distributed session management, WebSocket message distribution, token revocation, and rate limiting:

```mermaid
flowchart TD
    REDIS_URL["REDIS_URLenv.py:361"]
    REDIS_CLUSTER["REDIS_CLUSTERenv.py:362"]
    REDIS_PREFIX["REDIS_KEY_PREFIXenv.py:364"]
    SENTINEL_SETUP["Sentinel Setup"]
    SENTINEL_HOSTS["REDIS_SENTINEL_HOSTSenv.py:366"]
    SENTINEL_PORT["REDIS_SENTINEL_PORTenv.py:367"]
    SENTINEL_RETRY["REDIS_SENTINEL_MAX_RETRY_COUNTenv.py:370-376"]
    REDIS_CLIENT["Redis Clientutils/redis.py"]
    TOKEN_REVOKE["Token Revocationutils/auth.py:232-247"]
    RATE_LIMIT["Rate Limitingutils/rate_limit.py"]
    WEBSOCKET_DIST["WebSocket Distributionsocket/main.py"]
    SESSION_STORE["Session Storage"]

    SENTINEL --> HOSTS_SENTINEL_SETUP
    SENTINEL --> PORT_SENTINEL_SETUP
    SENTINEL --> RETRY_SENTINEL_SETUP
    REDIS --> URL_REDIS_CLIENT
    REDIS --> CLUSTER_REDIS_CLIENT
    REDIS --> PREFIX_REDIS_CLIENT
    SENTINEL --> SETUP_REDIS_CLIENT
    REDIS --> CLIENT_TOKEN_REVOKE
    REDIS --> CLIENT_RATE_LIMIT
    REDIS --> CLIENT_WEBSOCKET_DIST
    REDIS --> CLIENT_SESSION_STORE
```
**Redis Environment Variables:**

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `REDIS_URL` | string | "" | Redis connection URL (e.g., `redis://localhost:6379`) |
| `REDIS_CLUSTER` | bool | False | Enable Redis Cluster mode |
| `REDIS_KEY_PREFIX` | string | "open-webui" | Prefix for all Redis keys |
| `REDIS_SENTINEL_HOSTS` | string | "" | Comma-separated sentinel hosts |
| `REDIS_SENTINEL_PORT` | string | "26379" | Sentinel port |
| `REDIS_SENTINEL_MAX_RETRY_COUNT` | int | 2 | Max retries for sentinel failover |
| `REDIS_SOCKET_CONNECT_TIMEOUT` | float | None | Socket connection timeout in seconds |

**Sources:** [backend/open\_webui/env.py357-384](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L357-L384) [backend/open\_webui/utils/auth.py213-247](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/auth.py#L213-L247)

### Authentication and Security Configuration

```mermaid
flowchart TD
    WEBUI_AUTH["WEBUI_AUTHenv.py:403"]
    SECRET_KEY["WEBUI_SECRET_KEYenv.py:450-455"]
    JWT_ALGO["JWT Algorithm: HS256utils/auth.py:50"]
    TOKEN_CREATE["create_token()utils/auth.py:191-202"]
    TOKEN_DECODE["decode_token()utils/auth.py:205-210"]
    COOKIE_CONFIG["Cookie Configuration"]
    SAME_SITE["WEBUI_SESSION_COOKIE_SAME_SITEenv.py:457"]
    SECURE["WEBUI_SESSION_COOKIE_SECUREenv.py:459-461"]
    AUTH_SAME_SITE["WEBUI_AUTH_COOKIE_SAME_SITEenv.py:463-465"]
    AUTH_SECURE["WEBUI_AUTH_COOKIE_SECUREenv.py:467-473"]
    OAUTH_CONFIG["OAuth Configuration"]
    OAUTH_EMAIL_FALLBACK["ENABLE_OAUTH_EMAIL_FALLBACKenv.py:485-487"]
    OAUTH_ID_TOKEN["ENABLE_OAUTH_ID_TOKEN_COOKIEenv.py:489-491"]
    OAUTH_CLIENT_KEY["OAUTH_CLIENT_INFO_ENCRYPTION_KEYenv.py:493-495"]
    OAUTH_SESSION_KEY["OAUTH_SESSION_TOKEN_ENCRYPTION_KEYenv.py:497-499"]
    FERNET_ENCRYPT["Fernet Encryptionutils/oauth.py:132-155"]
    TRUSTED_HEADERS["Trusted Header Auth"]
    EMAIL_HEADER["WEBUI_AUTH_TRUSTED_EMAIL_HEADERenv.py:412-414"]
    NAME_HEADER["WEBUI_AUTH_TRUSTED_NAME_HEADERenv.py:415"]
    GROUPS_HEADER["WEBUI_AUTH_TRUSTED_GROUPS_HEADERenv.py:416-418"]
    PASSWORD_VALIDATION["Password Validation"]
    ENABLE_VALIDATION["ENABLE_PASSWORD_VALIDATIONenv.py:421-423"]
    REGEX_PATTERN["PASSWORD_VALIDATION_REGEX_PATTERNenv.py:424-435"]

    WEBUI --> AUTH_SECRET_KEY
    SECRET --> KEY_JWT_ALGO
    SECRET --> KEY_TOKEN_CREATE
    SECRET --> KEY_TOKEN_DECODE
    WEBUI --> AUTH_COOKIE_CONFIG
    COOKIE --> CONFIG_SAME_SITE
    COOKIE --> CONFIG_SECURE
    COOKIE --> CONFIG_AUTH_SAME_SITE
    COOKIE --> CONFIG_AUTH_SECURE
    WEBUI --> AUTH_OAUTH_CONFIG
    OAUTH --> CONFIG_OAUTH_EMAIL_FALLBACK
    OAUTH --> CONFIG_OAUTH_ID_TOKEN
    OAUTH --> CONFIG_OAUTH_CLIENT_KEY
    OAUTH --> CONFIG_OAUTH_SESSION_KEY
    OAUTH --> CLIENT_KEY_FERNET_ENCRYPT
    WEBUI --> AUTH_TRUSTED_HEADERS
    TRUSTED --> HEADERS_EMAIL_HEADER
    TRUSTED --> HEADERS_NAME_HEADER
    TRUSTED --> HEADERS_GROUPS_HEADER
    WEBUI --> AUTH_PASSWORD_VALIDATION
    PASSWORD --> VALIDATION_ENABLE_VALIDATION
    PASSWORD --> VALIDATION_REGEX_PATTERN
```
**Authentication Environment Variables:**

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `WEBUI_AUTH` | bool | True | Enable authentication system |
| `WEBUI_SECRET_KEY` | string | "t0p-s3cr3t" | **CRITICAL**: Secret key for JWT signing and encryption |
| `WEBUI_SESSION_COOKIE_SAME_SITE` | string | "lax" | SameSite attribute for session cookies |
| `WEBUI_SESSION_COOKIE_SECURE` | bool | False | Require HTTPS for session cookies |
| `WEBUI_AUTH_COOKIE_SAME_SITE` | string | (inherits from session) | SameSite for auth cookies |
| `WEBUI_AUTH_COOKIE_SECURE` | bool | (inherits from session) | Require HTTPS for auth cookies |
| `WEBUI_AUTH_SIGNOUT_REDIRECT_URL` | string | None | Redirect URL after sign out |
| `WEBUI_AUTH_TRUSTED_EMAIL_HEADER` | string | None | Header containing trusted email (e.g., `X-User-Email`) |
| `WEBUI_AUTH_TRUSTED_NAME_HEADER` | string | None | Header containing trusted name |
| `WEBUI_AUTH_TRUSTED_GROUPS_HEADER` | string | None | Header containing trusted groups |
| `ENABLE_INITIAL_ADMIN_SIGNUP` | bool | False | Allow first user to sign up as admin without invitation |
| `ENABLE_SIGNUP_PASSWORD_CONFIRMATION` | bool | False | Require password confirmation during signup |
| `ENABLE_PASSWORD_VALIDATION` | bool | False | Enable password complexity validation |
| `PASSWORD_VALIDATION_REGEX_PATTERN` | string | (complex regex) | Regex pattern for password validation |
| `BYPASS_MODEL_ACCESS_CONTROL` | bool | False | Disable per-model access control checks |
| `ENABLE_OAUTH_EMAIL_FALLBACK` | bool | False | Use email claim if username not available |
| `ENABLE_OAUTH_ID_TOKEN_COOKIE` | bool | True | Store OAuth ID token in cookie |
| `OAUTH_CLIENT_INFO_ENCRYPTION_KEY` | string | (from WEBUI\_SECRET\_KEY) | Key for encrypting OAuth client credentials |
| `OAUTH_SESSION_TOKEN_ENCRYPTION_KEY` | string | (from WEBUI\_SECRET\_KEY) | Key for encrypting OAuth session tokens |

**Sources:** [backend/open\_webui/env.py400-509](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L400-L509) [backend/open\_webui/utils/auth.py49-257](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/auth.py#L49-L257) [backend/open\_webui/utils/oauth.py132-165](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/utils/oauth.py#L132-L165)

### SCIM and License Configuration

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `ENABLE_SCIM` | bool | False | Enable SCIM 2.0 user provisioning |
| `SCIM_TOKEN` | string | "" | Bearer token for SCIM API authentication |
| `LICENSE_KEY` | string | "" | Enterprise license key |
| `LICENSE_BLOB_PATH` | path | `DATA_DIR/l.data` | Path to encrypted license blob file |
| `LICENSE_PUBLIC_KEY` | string | "" | Public key for license verification |

**Sources:** [backend/open\_webui/env.py502-536](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L502-L536)

### WebSocket Configuration

WebSocket support enables real-time chat updates, collaborative editing, and distributed message propagation:

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `ENABLE_WEBSOCKET_SUPPORT` | bool | True | Enable WebSocket functionality |
| `WEBSOCKET_MANAGER` | string | "" | WebSocket manager type |
| `WEBSOCKET_REDIS_URL` | string | (from REDIS\_URL) | Redis URL for WebSocket distribution |
| `WEBSOCKET_REDIS_CLUSTER` | bool | (from REDIS\_CLUSTER) | Use Redis Cluster for WebSocket |
| `WEBSOCKET_REDIS_OPTIONS` | JSON | None | Additional Redis client options |
| `WEBSOCKET_REDIS_LOCK_TIMEOUT` | int | 60 | Lock timeout for Redis operations |
| `WEBSOCKET_SENTINEL_HOSTS` | string | "" | Sentinel hosts for WebSocket Redis |
| `WEBSOCKET_SENTINEL_PORT` | string | "26379" | Sentinel port for WebSocket Redis |
| `WEBSOCKET_SERVER_LOGGING` | bool | False | Enable Socket.IO server logging |
| `WEBSOCKET_SERVER_ENGINEIO_LOGGING` | bool | False | Enable Engine.IO logging |
| `WEBSOCKET_SERVER_PING_TIMEOUT` | int | 20 | Ping timeout in seconds |
| `WEBSOCKET_SERVER_PING_INTERVAL` | int | 25 | Ping interval in seconds |

**Sources:** [backend/open\_webui/env.py608-668](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L608-L668)

### HTTP Client Configuration

Settings for `aiohttp` client used throughout the application:

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `AIOHTTP_CLIENT_TIMEOUT` | int | None | Default timeout for HTTP requests (seconds) |
| `AIOHTTP_CLIENT_SESSION_SSL` | bool | True | Verify SSL certificates |
| `AIOHTTP_CLIENT_TIMEOUT_MODEL_LIST` | int | 10 | Timeout for fetching model lists |
| `AIOHTTP_CLIENT_TIMEOUT_TOOL_SERVER_DATA` | int | 10 | Timeout for tool server data requests |
| `AIOHTTP_CLIENT_SESSION_TOOL_SERVER_SSL` | bool | True | Verify SSL for tool servers |

**Sources:** [backend/open\_webui/env.py670-717](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L670-L717)

### Storage Configuration

Open WebUI supports multiple storage backends through a polymorphic provider system:

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `STORAGE_PROVIDER` | string | "local" | Storage backend: `local`, `s3`, `gcs`, `azure` |
| `UPLOAD_DIR` | path | `DATA_DIR/uploads` | Local upload directory |
| `S3_BUCKET_NAME` | string | \- | S3 bucket name |
| `S3_REGION_NAME` | string | \- | S3 region |
| `S3_ENDPOINT_URL` | string | \- | Custom S3 endpoint (for MinIO, etc.) |
| `S3_ACCESS_KEY_ID` | string | \- | S3 access key |
| `S3_SECRET_ACCESS_KEY` | string | \- | S3 secret key |
| `GCS_BUCKET_NAME` | string | \- | Google Cloud Storage bucket |
| `GCS_CREDENTIALS_PATH` | path | \- | Path to GCS service account JSON |
| `AZURE_STORAGE_ACCOUNT_NAME` | string | \- | Azure storage account |
| `AZURE_STORAGE_CONTAINER_NAME` | string | \- | Azure container name |
| `AZURE_STORAGE_ACCOUNT_KEY` | string | \- | Azure account key |
| `AZURE_STORAGE_CONNECTION_STRING` | string | \- | Azure connection string |

See [Storage Provider Architecture](/open-webui/open-webui/12.1-storage-provider-architecture) for implementation details.

**Sources:** [backend/open\_webui/config.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/config.py) (storage configuration is loaded in the config module)

### Performance and Scaling Configuration

```mermaid
flowchart TD
    UVICORN["UVICORN_WORKERSenv.py:390-397"]
    CACHE["Caching Configuration"]
    MODELS_TTL["MODELS_CACHE_TTLenv.py:546-553"]
    QUERIES_CACHE["ENABLE_QUERIES_CACHEenv.py:355"]
    CHAT["Chat Configuration"]
    STREAM_DELTA["CHAT_RESPONSE_STREAM_DELTA_CHUNK_SIZEenv.py:565-577"]
    MAX_RETRIES["CHAT_RESPONSE_MAX_TOOL_CALL_RETRIESenv.py:580-590"]
    BUFFER_SIZE["CHAT_STREAM_RESPONSE_CHUNK_MAX_BUFFER_SIZEenv.py:593-605"]
    WORKERS["Multiple WorkerProcesses"]
    REDIS_SESSION["Redis-basedSession Sharing"]
    MEMORY["In-memory@cached decorator"]
    STREAM_HANDLER["Stream ResponseProcessing"]

    UVICORN --> WORKERS
    MODELS --> TTL_CACHE
    QUERIES --> CACHE_CACHE
    STREAM --> DELTA_CHAT
    MAX --> RETRIES_CHAT
    BUFFER --> SIZE_CHAT
    WORKERS --> REDIS_SESSION
    CACHE --> MEMORY
    CHAT --> STREAM_HANDLER
```
**Performance Environment Variables:**

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `UVICORN_WORKERS` | int | 1 | Number of Uvicorn worker processes (requires Redis for >1) |
| `MODELS_CACHE_TTL` | int | 1 | Model list cache TTL in seconds (None = no cache) |
| `ENABLE_QUERIES_CACHE` | bool | False | Enable database query result caching |
| `CHAT_RESPONSE_STREAM_DELTA_CHUNK_SIZE` | int | 1 | Number of chunks to accumulate before streaming |
| `CHAT_RESPONSE_MAX_TOOL_CALL_RETRIES` | int | 30 | Max retries for tool call execution |
| `CHAT_STREAM_RESPONSE_CHUNK_MAX_BUFFER_SIZE` | int | None | Max buffer size for streaming responses |

**Sources:** [backend/open\_webui/env.py386-606](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L386-L606)

### Sentence Transformers Configuration

For local embedding generation and reranking:

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `SENTENCE_TRANSFORMERS_BACKEND` | string | "torch" | Backend for sentence transformers |
| `SENTENCE_TRANSFORMERS_MODEL_KWARGS` | JSON | None | Model initialization kwargs |
| `SENTENCE_TRANSFORMERS_CROSS_ENCODER_BACKEND` | string | "torch" | Backend for cross-encoder |
| `SENTENCE_TRANSFORMERS_CROSS_ENCODER_MODEL_KWARGS` | JSON | None | Cross-encoder kwargs |

**Sources:** [backend/open\_webui/env.py719-762](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L719-L762)

### Observability Configuration

OpenTelemetry (OTEL) integration for traces, metrics, and logs:

```mermaid
flowchart TD
    ENABLE_OTEL["ENABLE_OTELenv.py:812"]
    TRACES["ENABLE_OTEL_TRACESenv.py:813"]
    METRICS["ENABLE_OTEL_METRICSenv.py:814"]
    LOGS["ENABLE_OTEL_LOGSenv.py:815"]
    TRACE_ENDPOINT["OTEL_EXPORTER_OTLP_ENDPOINTenv.py:817-819"]
    METRIC_ENDPOINT["OTEL_METRICS_EXPORTER_OTLP_ENDPOINTenv.py:820-822"]
    LOG_ENDPOINT["OTEL_LOGS_EXPORTER_OTLP_ENDPOINTenv.py:823-825"]
    TRACE_INSECURE["OTEL_EXPORTER_OTLP_INSECUREenv.py:826-828"]
    METRIC_INSECURE["OTEL_METRICS_EXPORTER_OTLP_INSECUREenv.py:829-834"]
    LOG_INSECURE["OTEL_LOGS_EXPORTER_OTLP_INSECUREenv.py:835-840"]
    SAMPLER["OTEL_TRACES_SAMPLERenv.py:845-847"]
    AUTH["Authentication"]
    BASIC_USER["OTEL_BASIC_AUTH_USERNAMEenv.py:848"]
    BASIC_PASS["OTEL_BASIC_AUTH_PASSWORDenv.py:849"]
    EXPORTER_TYPE["OTEL_OTLP_SPAN_EXPORTERenv.py:864-866"]

    ENABLE --> OTEL_TRACES
    ENABLE --> OTEL_METRICS
    ENABLE --> OTEL_LOGS
    TRACES --> TRACE_ENDPOINT
    METRICS --> METRIC_ENDPOINT
    LOGS --> LOG_ENDPOINT
    TRACE --> ENDPOINT_TRACE_INSECURE
    METRIC --> ENDPOINT_METRIC_INSECURE
    LOG --> ENDPOINT_LOG_INSECURE
    TRACES --> SAMPLER
    TRACES --> AUTH
    METRICS --> AUTH
    LOGS --> AUTH
    AUTH --> BASIC_USER
    AUTH --> BASIC_PASS
    TRACES --> EXPORTER_TYPE
```
**OpenTelemetry Environment Variables:**

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `ENABLE_OTEL` | bool | False | Enable OpenTelemetry instrumentation |
| `ENABLE_OTEL_TRACES` | bool | False | Enable trace export |
| `ENABLE_OTEL_METRICS` | bool | False | Enable metrics export |
| `ENABLE_OTEL_LOGS` | bool | False | Enable log export |
| `OTEL_EXPORTER_OTLP_ENDPOINT` | string | "[http://localhost:4317](http://localhost:4317)" | OTLP endpoint for traces |
| `OTEL_METRICS_EXPORTER_OTLP_ENDPOINT` | string | (from OTEL\_EXPORTER\_OTLP\_ENDPOINT) | OTLP endpoint for metrics |
| `OTEL_LOGS_EXPORTER_OTLP_ENDPOINT` | string | (from OTEL\_EXPORTER\_OTLP\_ENDPOINT) | OTLP endpoint for logs |
| `OTEL_EXPORTER_OTLP_INSECURE` | bool | False | Disable TLS for OTLP |
| `OTEL_SERVICE_NAME` | string | "open-webui" | Service name in telemetry |
| `OTEL_RESOURCE_ATTRIBUTES` | string | "" | Additional resource attributes (key1=val1,key2=val2) |
| `OTEL_TRACES_SAMPLER` | string | "parentbased\_always\_on" | Trace sampling strategy |
| `OTEL_BASIC_AUTH_USERNAME` | string | "" | Basic auth username for OTLP |
| `OTEL_BASIC_AUTH_PASSWORD` | string | "" | Basic auth password for OTLP |
| `OTEL_OTLP_SPAN_EXPORTER` | string | "grpc" | Exporter protocol: "grpc" or "http" |

**Sources:** [backend/open\_webui/env.py808-875](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L808-L875)

### Audit Logging Configuration

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `AUDIT_LOGS_FILE_PATH` | path | `DATA_DIR/audit.log` | Path to audit log file |
| `AUDIT_LOG_FILE_ROTATION_SIZE` | string | "10MB" | Max size before log rotation |
| `AUDIT_UVICORN_LOGGER_NAMES` | list | \["uvicorn.access"\] | Logger names to capture |
| `AUDIT_LOG_LEVEL` | string | "NONE" | Audit level: NONE, METADATA, REQUEST, REQUEST\_RESPONSE |
| `MAX_BODY_LOG_SIZE` | int | 2048 | Max bytes to log from request/response bodies |
| `AUDIT_EXCLUDED_PATHS` | list | \["/chats", "/chat", "/folders"\] | Paths to exclude from audit |

**Sources:** [backend/open\_webui/env.py777-806](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L777-L806)

### Feature Flags and Miscellaneous

| Variable | Type | Default | Description |
| --- | --- | --- | --- |
| `ENV` | string | "dev" | Environment: dev, test, prod |
| `DOCKER` | bool | False | Running in Docker container |
| `USE_CUDA_DOCKER` | string | "false" | Use CUDA in Docker |
| `DEVICE_TYPE` | string | "cpu" | Device for ML models: cpu, cuda, mps |
| `GLOBAL_LOG_LEVEL` | string | "INFO" | Global logging level |
| `SAFE_MODE` | bool | False | Enable safe mode (restricts certain operations) |
| `ENABLE_FORWARD_USER_INFO_HEADERS` | bool | False | Forward X-OpenWebUI-User-\* headers to backends |
| `ENABLE_COMPRESSION_MIDDLEWARE` | bool | True | Enable gzip compression |
| `ENABLE_CUSTOM_MODEL_FALLBACK` | bool | False | Allow fallback to alternate models |
| `ENABLE_CHAT_RESPONSE_BASE64_IMAGE_URL_CONVERSION` | bool | False | Convert base64 images to URLs |
| `ENABLE_REALTIME_CHAT_SAVE` | bool | False | Save chat messages in real-time |
| `RESET_CONFIG_ON_START` | bool | False | Reset configuration to defaults on startup |
| `ENABLE_PUBLIC_ACTIVE_USERS_COUNT` | bool | True | Show active user count to non-admins |
| `OFFLINE_MODE` | bool | False | Disable external network requests (sets HF\_HUB\_OFFLINE=1) |
| `ENABLE_VERSION_UPDATE_CHECK` | bool | True | Check for new versions (disabled if OFFLINE\_MODE) |
| `WEBUI_NAME` | string | "Open WebUI" | Application name |
| `WEBUI_FAVICON_URL` | string | "[https://openwebui.com/favicon.png](https://openwebui.com/favicon.png)" | Favicon URL |
| `WEBUI_BUILD_HASH` | string | "dev-build" | Build hash for frontend |
| `DEPLOYMENT_ID` | string | "" | Unique deployment identifier |
| `INSTANCE_ID` | string | (generated UUID) | Unique instance identifier |
| `TRUSTED_SIGNATURE_KEY` | string | "" | Key for verifying signed payloads |

**Sources:** [backend/open\_webui/env.py41-204](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L41-L204) [backend/open\_webui/env.py542-889](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L542-L889)

## Configuration in Docker Deployments

Environment variables are commonly passed to Docker containers via the `-e` flag or docker-compose `environment` section:

### Example: Basic Ollama Connection

```
docker run -d -p 3000:8080 \
  -e OLLAMA_BASE_URL=http://host.docker.internal:11434 \
  -v open-webui:/app/backend/data \
  --name open-webui \
  ghcr.io/open-webui/open-webui:main
```
### Example: OpenAI API Configuration

```
docker run -d -p 3000:8080 \
  -e OPENAI_API_KEY=sk-xxxx \
  -v open-webui:/app/backend/data \
  --name open-webui \
  ghcr.io/open-webui/open-webui:main
```
### Example: PostgreSQL with Redis

```
docker run -d -p 3000:8080 \
  -e DATABASE_URL=postgresql://user:pass@postgres:5432/openwebui \
  -e REDIS_URL=redis://redis:6379/0 \
  -e UVICORN_WORKERS=4 \
  -v open-webui:/app/backend/data \
  --name open-webui \
  ghcr.io/open-webui/open-webui:main
```
**Sources:** [README.md119-193](https://github.com/open-webui/open-webui/blob/a7271532/README.md#L119-L193) [TROUBLESHOOTING.md16-19](https://github.com/open-webui/open-webui/blob/a7271532/TROUBLESHOOTING.md#L16-L19)

## Configuration Validation and Error Handling

The `env.py` module includes validation logic for critical variables:

```mermaid
flowchart TD
    LOAD["Load Environment Variables"]
    VALIDATE_SECRET["Validate WEBUI_SECRET_KEYenv.py:475-476"]
    SECRET_CHECK["WEBUI_AUTH andSECRET_KEY empty?"]
    RAISE_ERROR["Raise ValueErrorERROR_MESSAGES.ENV_VAR_NOT_FOUND"]
    CONTINUE["Continue Loading"]
    PARSE_INT["Parse Integer Values"]
    INT_TRY["Try int() conversion"]
    DEFAULT_INT["Use default valuee.g., env.py:292-295"]
    SET_INT["Set integer value"]
    PARSE_BOOL["Parse Boolean Values"]
    BOOL_CHECK[".lower() == 'true'"]
    SET_TRUE["Set True"]
    SET_FALSE["Set False"]
    PARSE_JSON["Parse JSON Values"]
    JSON_TRY["Try json.loads()"]
    DEFAULT_JSON["Set None or defaulte.g., env.py:632-635"]
    SET_JSON["Set parsed JSON"]

    LOAD --> VALIDATE_SECRET
    VALIDATE --> SECRET_SECRET_CHECK
    SECRET --> CHECK_RAISE_ERROR
    SECRET --> CHECK_CONTINUE
    CONTINUE --> PARSE_INT
    PARSE --> INT_INT_TRY
    INT --> TRY_DEFAULT_INT
    INT --> TRY_SET_INT
    CONTINUE --> PARSE_BOOL
    PARSE --> BOOL_BOOL_CHECK
    BOOL --> CHECK_SET_TRUE
    BOOL --> CHECK_SET_FALSE
    CONTINUE --> PARSE_JSON
    PARSE --> JSON_JSON_TRY
    JSON --> TRY_DEFAULT_JSON
    JSON --> TRY_SET_JSON
```
**Examples from code:**

```
# Integer parsing with default (env.py:289-295)
DATABASE_POOL_SIZE = os.environ.get("DATABASE_POOL_SIZE", None)
if DATABASE_POOL_SIZE != None:
    try:
        DATABASE_POOL_SIZE = int(DATABASE_POOL_SIZE)
    except Exception:
        DATABASE_POOL_SIZE = None
```
```
# Boolean parsing (env.py:362)
REDIS_CLUSTER = os.environ.get("REDIS_CLUSTER", "False").lower() == "true"
```
```
# JSON parsing with default (env.py:629-635)
WEBSOCKET_REDIS_OPTIONS = os.environ.get("WEBSOCKET_REDIS_OPTIONS", "")
if WEBSOCKET_REDIS_OPTIONS == "":
    WEBSOCKET_REDIS_OPTIONS = None
else:
    try:
        WEBSOCKET_REDIS_OPTIONS = json.loads(WEBSOCKET_REDIS_OPTIONS)
    except Exception:
        WEBSOCKET_REDIS_OPTIONS = None
```
**Sources:** [backend/open\_webui/env.py289-635](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L289-L635)

## Environment Variables vs. Persistent Configuration

Open WebUI uses a two-tier configuration system:

1.  **Environment Variables** (covered in this document): Set at container startup, control infrastructure and initial settings
2.  **Persistent Configuration** (see [Persistent Configuration System](/open-webui/open-webui/11.2-persistent-configuration-system)): Stored in database, modifiable via admin UI, persists across restarts

```mermaid
flowchart TD
    ENV_VARS["Environment VariablesSystem Level"]
    INIT["Application Startupmain.py"]
    APP_CONFIG["AppConfig Instanceconfig.py"]
    DB_LOAD["Load from Databaseconfig table"]
    RUNTIME["Runtime Configurationapp.state.config"]
    ADMIN_UI["Admin UISettings Modal"]
    UPDATE_API["POST /api/config"]
    DB_SAVE["Save to Database"]

    ENV --> VARS_INIT
    INIT --> APP_CONFIG
    APP --> CONFIG_DB_LOAD
    DB --> LOAD_RUNTIME
    RUNTIME --> ADMIN_UI
    ADMIN --> UI_UPDATE_API
    UPDATE --> API_DB_SAVE
    DB --> SAVE_RUNTIME
    ENV --> VARS_APP_CONFIG
```
**Key differences:**

-   Environment variables: `OLLAMA_BASE_URL`, `DATABASE_URL`, `REDIS_URL`, `WEBUI_SECRET_KEY` (infrastructure)
-   Persistent config: Ollama API endpoints, OpenAI API keys, feature toggles, user preferences (operational)

Some variables can be set via both mechanisms. Environment variables typically provide initial/default values, while persistent configuration overrides them for operational flexibility.

**Sources:** [backend/open\_webui/env.py1-889](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L1-L889) [backend/open\_webui/config.py](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/config.py)

## Common Configuration Patterns

### Development Environment

```
# .env file for local development
ENV=dev
DATA_DIR=./data
WEBUI_SECRET_KEY=dev-secret-key-change-in-production
DATABASE_URL=sqlite:///./data/webui.db
OLLAMA_BASE_URL=http://localhost:11434
ENABLE_OLLAMA_API=True
ENABLE_OPENAI_API=False
GLOBAL_LOG_LEVEL=DEBUG
```
### Production with External Database

```
# Production environment variables
ENV=prod
WEBUI_SECRET_KEY=<strong-random-key>
DATABASE_URL=postgresql://openwebui:password@db-host:5432/openwebui
DATABASE_POOL_SIZE=20
DATABASE_POOL_MAX_OVERFLOW=10
REDIS_URL=redis://redis-host:6379/0
UVICORN_WORKERS=4
ENABLE_OTEL=True
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4317
AIOHTTP_CLIENT_SESSION_SSL=True
```
### Multi-Node Deployment with Redis Sentinel

```
# Redis Sentinel configuration for HA
REDIS_SENTINEL_HOSTS=sentinel1,sentinel2,sentinel3
REDIS_SENTINEL_PORT=26379
REDIS_SENTINEL_MAX_RETRY_COUNT=3
WEBSOCKET_REDIS_URL=redis://redis-master:6379/0
WEBSOCKET_SENTINEL_HOSTS=sentinel1,sentinel2,sentinel3
UVICORN_WORKERS=8
```
### Cloud Storage Configuration

```
# S3-compatible storage
STORAGE_PROVIDER=s3
S3_BUCKET_NAME=openwebui-uploads
S3_REGION_NAME=us-east-1
S3_ENDPOINT_URL=https://s3.amazonaws.com
S3_ACCESS_KEY_ID=AKIAXXXXXXXXXXXX
S3_SECRET_ACCESS_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```
**Sources:** [README.md86-212](https://github.com/open-webui/open-webui/blob/a7271532/README.md#L86-L212) [backend/open\_webui/env.py210-889](https://github.com/open-webui/open-webui/blob/a7271532/backend/open_webui/env.py#L210-L889)
